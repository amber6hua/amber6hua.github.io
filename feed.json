{
    "version": "https://jsonfeed.org/version/1",
    "title": "Amber",
    "subtitle": "六花丶紫",
    "icon": "https://amber6hua.github.io/images/favicon.ico",
    "description": "Amber Room",
    "home_page_url": "https://amber6hua.github.io",
    "items": [
        {
            "id": "https://amber6hua.github.io/linux/autobangumi/",
            "url": "https://amber6hua.github.io/linux/autobangumi/",
            "title": "部署 AutoBangumi 自动追番工具",
            "date_published": "2023-09-11T09:11:39.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VzdHJlbGxhWEQvQXV0b19CYW5ndW1p\">AutoBangumi 自动追番工具</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2plcnJ5bWFrZXNqZWxseS9hdXRvcmVtb3ZlLXRvcnJlbnRz\">autoremove-torrents 自动删种程序</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9taWthbmFuaS5tZQ==\">蜜柑计划</span></li>\n</ul>\n<p>在自己的私人服务器上，搭建<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0VzdHJlbGxhWEQvQXV0b19CYW5ndW1p\"> AutoBangumi 自动追番工具</span><br />\n可以追番或订阅某一部番剧</p>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuaGltaWt1LmNvbS9hcmNoaXZlcy9hdXRvLWJhbmd1bWkuaHRtbA==\">https://www.himiku.com/archives/auto-bangumi.html</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jcm9zc2JlbGwuaW8vbm90ZXMvNTExMjQtMzQ=\">https://crossbell.io/notes/51124-34</span></li>\n</ul>\n<h2 id=\"docker-autobangumi\"><a class=\"anchor\" href=\"#docker-autobangumi\">#</a> Docker AutoBangumi</h2>\n<p>项目文档 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYXV0b2Jhbmd1bWkub3JnL2RlcGxveS9kb2NrZXItY29tcG9zZS5odG1s\">https://www.autobangumi.org/deploy/docker-compose.html</span></p>\n<h3 id=\"通过docker-composeyml-安装-qbittorrent-与-autobangumi\"><a class=\"anchor\" href=\"#通过docker-composeyml-安装-qbittorrent-与-autobangumi\">#</a> 通过 docker-compose.yml 安装 qBittorrent 与 AutoBangumi</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> autoBangumi <span class=\"token operator\">&amp;&amp;</span> autoBangumi</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">wget</span> https://raw.githubusercontent.com/EstrellaXD/Auto_Bangumi/main/docs/docker-compose/qBittorrent+AutoBangumi/docker-compose.yml</pre></td></tr></table></figure><h3 id=\"定义变量\"><a class=\"anchor\" href=\"#定义变量\">#</a> 定义变量</h3>\n<p>在 docker-compose.yml 统计目录下，创建 .env 文件</p>\n<p>vi .env</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>DOWNLOAD_PATH=./downloads</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>QB_PORT=8080</pre></td></tr></table></figure><h3 id=\"启动\"><a class=\"anchor\" href=\"#启动\">#</a> 启动</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker-compose up -d</pre></td></tr></table></figure><h3 id=\"登录\"><a class=\"anchor\" href=\"#登录\">#</a> 登录</h3>\n<p>autoBangumi 后台 http://&lt;ip&gt;:7892  默认账密 admin  adminadmin<br />\nqBittorrent 后台 http://&lt;ip&gt;:8080  默认账密 admin  adminadmin</p>\n<h2 id=\"autoremove-torrents\"><a class=\"anchor\" href=\"#autoremove-torrents\">#</a> autoremove-torrents</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2plcnJ5bWFrZXNqZWxseS9hdXRvcmVtb3ZlLXRvcnJlbnRz\">autoremove-torrents 自动删种程序</span></p>\n<h3 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h3>\n<p>从 pip 安装</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> autoremove-torrents</pre></td></tr></table></figure><p>或者</p>\n<p>从 GitHub 安装</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> clone https://github.com/jerrymakesjelly/autoremove-torrents.git</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> autoremove-torrents</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>python3 setup.py <span class=\"token function\">install</span></pre></td></tr></table></figure><h3 id=\"配置\"><a class=\"anchor\" href=\"#配置\">#</a> 配置</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9hdXRvcmVtb3ZlLXRvcnJlbnRzLnJlYWR0aGVkb2NzLmlvL3poX0NOL2xhdGVzdC9jb25maWcuaHRtbCNwYXJ0LTMtc3RyYXRlZ3ktYmxvY2s=\">策略配置</span></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> autoremove <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> autoremove</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span> ./config.yml</pre></td></tr></table></figure><p>例子</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">my_task</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span> qbittorrent</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//127.0.0.1<span class=\"token punctuation\">:</span><span class=\"token number\">8080</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> admin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> adminadmin</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token key atrule\">strategies</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">my_strategy</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token key atrule\">categories</span><span class=\"token punctuation\">:</span> Bangumi</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token key atrule\">remove</span><span class=\"token punctuation\">:</span> seeding_time <span class=\"token punctuation\">></span> 1209600 or ratio <span class=\"token punctuation\">></span> 1</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token key atrule\">delete_data</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr></table></figure><p>配置说明<br />\n host: qbittorrent 的服务， 8080 是上面自定义的端口号<br />\n categories: qbittorrent 下载时的分类，如 Bangumi<br />\nseeding_time 最长做种时间<br />\n ratio 分享率</p>\n<h3 id=\"运行\"><a class=\"anchor\" href=\"#运行\">#</a> 运行</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 如果你只是想看看哪些种子会被删除但并不想真的就删除它们，请使用 --view 命令行参数（autoremove-torrents --view）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>autoremove-torrents</pre></td></tr></table></figure><h3 id=\"设置计划任务\"><a class=\"anchor\" href=\"#设置计划任务\">#</a> 设置计划任务</h3>\n<p>如果你想每 15 分钟检查一次哪些种子可以被删除，Linux 的 crontab 程序可以帮你。首先:</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">crontab</span> -e</pre></td></tr></table></figure><p>然后，在文件的最后加一行（请先确认 autoremove-torrents 在你系统中的路径）:</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># --conf 参数指示了配置文件的路径。 --log 参数指定了存储日志文件的路径（必须存在）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>*/15 * * * * /usr/bin/autoremove-torrents --conf<span class=\"token operator\">=</span>/home/autoremove/config.yml --log<span class=\"token operator\">=</span>/home/autoremove/logs</pre></td></tr></table></figure><h2 id=\"踩坑\"><a class=\"anchor\" href=\"#踩坑\">#</a> 踩坑</h2>\n<p>无法删除做种资源<br />\n autoremovetorrents.task ERROR: The torrent .mp4 and its data cannot be removed. Reason: The server responses HTTP 405</p>\n<p>qbittorrent 的版本太高，和 autoremove-torrents 不适配<br />\n可以降低 qbittorrent 版本 如 4.4.5_v2.0.8</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> bangumi</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 先停止并删除之前的 qbittorrent 容器</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>docker-compose stop <span class=\"token operator\">&amp;&amp;</span> docker <span class=\"token function\">rm</span> qBittorrent</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#再修改 docker-compose.yml</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">vi</span> docker-compose.yml</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 重启启动</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>docker-compose up -d</pre></td></tr></table></figure><p>docker-compose.yml</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.2\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">qbittorrent</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> qBittorrent</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">-</span> TemPath=/downloads</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">-</span> SavePath=/downloads</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> PGID=$<span class=\"token punctuation\">&#123;</span>GID<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">-</span> PUID=$<span class=\"token punctuation\">&#123;</span>UID<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> WEBUI_PORT=$<span class=\"token punctuation\">&#123;</span>QB_PORT<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> qb_config<span class=\"token punctuation\">:</span>/config</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">&#123;</span>DOWNLOAD_PATH<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">:</span>/downloads <span class=\"token comment\"># 填入下载绝对路径</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">&#123;</span>QB_PORT<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">&#123;</span>QB_PORT<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"6881:6881\"</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"6881:6881/udp\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token punctuation\">-</span> auto_bangumi</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> superng6/qbittorrent<span class=\"token punctuation\">:</span>4.4.5_v2.0.8</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token key atrule\">auto_bangumi</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> AutoBangumi</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token punctuation\">-</span> PGID=$<span class=\"token punctuation\">&#123;</span>GID<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token punctuation\">-</span> PUID=$<span class=\"token punctuation\">&#123;</span>UID<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token punctuation\">-</span> AB_DOWNLOADER_HOST=qbittorrent<span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">&#123;</span>QB_PORT<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./config<span class=\"token punctuation\">:</span>/app/config</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./data<span class=\"token punctuation\">:</span>/app/data</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      <span class=\"token punctuation\">-</span> auto_bangumi</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">'7892:7892'</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token key atrule\">dns</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      <span class=\"token punctuation\">-</span> 8.8.8.8</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>      <span class=\"token punctuation\">-</span> 223.5.5.5</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> estrellaxd/auto_bangumi<span class=\"token punctuation\">:</span>latest</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      <span class=\"token punctuation\">-</span> qbittorrent</pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  <span class=\"token key atrule\">auto_bangumi</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token key atrule\">qb_config</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token key atrule\">external</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr></table></figure>",
            "tags": [
                "Linux",
                "教程",
                "Linux"
            ]
        },
        {
            "id": "https://amber6hua.github.io/n1-coreelec/",
            "url": "https://amber6hua.github.io/n1-coreelec/",
            "title": "N1 从网心云到CoreElec",
            "date_published": "2023-09-07T01:12:12.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>一直想整个 N1 玩一下，终于在某鱼花了 98 入手了，在等待的到货的过程中，在百度、恩山看了几天的文章教程。<br />\n在众多大神的固件中纠结徘徊，一开始想刷 Armbian, 然后有想刷小钢炮，最后决定刷 CoreElec。</p>\n<p>卖家之前装的是网心云，需要利用拆机短接救砖的方法，刷回官方镜像。比如 v2.19 固件（小于 22 不需要降级）<br />\n开启 ADB 调试，连接上显示器和鼠标，用鼠标点击斐讯 N1 官方固件的那个版本号 3 4 次，出现 【ADB 调试开启】的字样即可</p>\n<h2 id=\"准备工具\"><a class=\"anchor\" href=\"#准备工具\">#</a> 准备工具</h2>\n<ul>\n<li>U 盘或 SD 卡 + 读卡器（听说闪迪的好，正好我就是。读卡器是随便买的杂牌，我都有）</li>\n<li>双公 USB 线</li>\n<li>微型螺丝刀（那种很小很细的双头螺丝刀）</li>\n<li>网线</li>\n<li>HDMI 线</li>\n<li>支持 HDMI 的电视或者显示器</li>\n<li>USB 接口鼠标</li>\n<li>电脑 (win7 win10 win11, 系统越老应该越稳定)</li>\n<li>能导电的小物件（我拆了坏的耳机的线控，找到了一块小铁片，前面试了几个东西，短接都不成功）</li>\n<li>软件\n<ul>\n<li>Win32DiskImager (制作 u 盘启动)</li>\n<li>晶晨线刷工具 Amlogic USB_Burning_Tool</li>\n<li>SSH 工具 (PuTTY、SecureCRT 等)</li>\n<li>N1 进线刷工具包文件</li>\n<li>N1U 盘启动脚本</li>\n</ul>\n</li>\n<li>固件镜像\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0RhbWVubHkvY29yZWVsZWMvcmVsZWFzZXMv\">CoreELEC 20.1 for Phicomm N1</span> 感谢 Damenly，什么新我用什么</li>\n<li>szkifen 大的斐讯 N1 专用 EMUELEC3.1 官方纯净版 (链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMTIzNnNjQkJYaTdzVk1jX2NtQVdrdlE=\">https://pan.baidu.com/s/1236scBBXi7sVMc_cmAWkvQ</span> 提取码：n950)</li>\n<li>v2.19 官方固件</li>\n<li>其他安卓固件，如 W 大固件 (可选)</li>\n</ul>\n</li>\n<li>reboot_update.apk (安装到安卓固件里的 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMUo2NUx4b3V3ZWczdmY5STlISC0wLWc=\">https://pan.baidu.com/s/1J65Lxouweg3vf9I9HH-0-g</span> 提取码: i7mf)</li>\n</ul>\n<h3 id=\"工具箱链接\"><a class=\"anchor\" href=\"#工具箱链接\">#</a> 工具箱链接</h3>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9maWxlLnpodXltLmNvbS8/ZGlyPS9OMQ==\">https://file.zhuym.com/?dir=/N1</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yb20ubmFub2RtLm5ldC9OMS8=\">https://rom.nanodm.net/N1/</span></li>\n</ul>\n<h2 id=\"拆机短接救砖包括网心云等非安卓系统无法通过usb启动的同样可以\"><a class=\"anchor\" href=\"#拆机短接救砖包括网心云等非安卓系统无法通过usb启动的同样可以\">#</a> 拆机短接救砖 (包括网心云等非安卓系统，无法通过 USB 启动的同样可以)</h2>\n<p>参考链接</p>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMTlKNDExYzdaZg==\">https://www.bilibili.com/video/BV19J411c7Zf</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucmlnaHQuY29tLmNuL2ZvcnVtL3RocmVhZC02MjE4NTk0LTEtMS5odG1s\">https://www.right.com.cn/forum/thread-6218594-1-1.html</span></li>\n</ul>\n<h3 id=\"拆机\"><a class=\"anchor\" href=\"#拆机\">#</a> 拆机</h3>\n<p>撕开底部 4 处垫脚，露出螺丝孔，用之前准备的微型螺丝刀，卸下螺丝。最后找东西，大胆的撬开底盖。露出主板。找到需要短接的两个点。</p>\n<h3 id=\"晶晨线刷工具-amlogic-usb_burning_tool\"><a class=\"anchor\" href=\"#晶晨线刷工具-amlogic-usb_burning_tool\">#</a> 晶晨线刷工具 Amlogic USB_Burning_Tool</h3>\n<ol>\n<li>安装 USB_Burning_Tool</li>\n<li>导入镜像包</li>\n</ol>\n<h3 id=\"短接救砖\"><a class=\"anchor\" href=\"#短接救砖\">#</a> 短接救砖</h3>\n<ol>\n<li>先用双公头，一端连接 N1 盒子，靠近 HDMI 口的 USB 接口。另一端连接电脑 USB（台式机最好接后面，不过我用的是笔记本，还是 WIN11 的系统）</li>\n<li>准备好电源，先不接入 N1 盒子。</li>\n<li>用能导电的小物件，短接两个点，然后接入电源。</li>\n<li>成功的话，会读取到设备，否则可能是介质不导电，或者短接不成功，多试几次，</li>\n</ol>\n<h3 id=\"刷入官方固件\"><a class=\"anchor\" href=\"#刷入官方固件\">#</a> 刷入官方固件</h3>\n<ul>\n<li>具体步骤还是看<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMTlKNDExYzdaZg==\">韩风大佬的救砖视频</span>，刷入官方固件，到此救砖成功</li>\n<li>之后为了刷其他镜像，需要开启 ADB 调试 (连接上显示器和鼠标，用鼠标点击斐讯 N1 官方固件的那个版本号 3 4 次，出现 【ADB 调试开启】的字样即可)</li>\n</ul>\n<h3 id=\"刷入安卓固件\"><a class=\"anchor\" href=\"#刷入安卓固件\">#</a> 刷入安卓固件</h3>\n<blockquote>\n<p>还是韩风大佬的视频 4 大固件任意刷 （根据需要刷其他安卓固件，我选的是 W 大的固件）</p>\n</blockquote>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMW1KNDExZzdmUw==\">https://www.bilibili.com/video/BV1mJ411g7fS</span></li>\n</ul>\n<h2 id=\"安装coreelec\"><a class=\"anchor\" href=\"#安装coreelec\">#</a> 安装 CoreElec</h2>\n<p>成功进入大佬的安卓固件，通过 N1 U 盘启动脚本，进入 CoreElec。<br />\n但是画面一直卡在 905d 的 logo 界面，或者 Recovery 界面，换了几种版本，仍然不行。<br />\n在安卓固件中安装 reboot_update.apk 也不行。<br />\n最后发现使用刷入 emuelec 3.1 镜像的成功 U 盘启动了。<br />\n之后再换 CoreElec 镜像的 U 盘能正常启动了。<br />\n这里总结下过程。</p>\n<p>参考链接</p>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucmlnaHQuY29tLmNuL2ZvcnVtL3RocmVhZC00MTMwNTQ3LTEtMS5odG1s\">https://www.right.com.cn/forum/thread-4130547-1-1.html</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuem5kcy5jb20vZm9ydW0ucGhwP21vZD12aWV3dGhyZWFkJmFtcDt0aWQ9MTE4OTI2MyZhbXA7cGFnZT0x\">https://www.znds.com/forum.php?mod=viewthread&amp;tid=1189263&amp;page=1</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucmlnaHQuY29tLmNuL0ZPUlVNL2ZvcnVtLnBocD9tb2Q9dmlld3RocmVhZCZhbXA7dGlkPTQxMTM0OTU=\">https://www.right.com.cn/FORUM/forum.php?mod=viewthread&amp;tid=4113495</span></li>\n</ul>\n<h3 id=\"划重点\"><a class=\"anchor\" href=\"#划重点\">#</a> 划重点</h3>\n<p>优盘启动每次都进安卓恢复界面，小机器人倒地，启动不了，据说可能是挑盘，n1 插 u 盘进不去系统，机器人倒地<br />\n可以先刷 emuelec 进 u 盘，插 n1 启动后，再刷 coreelec 进 u 盘，<br />\nn1 就能正确引导进 coreelec，只要能进一次优盘系统，以后就都能优盘启动了， 而且不挑盘。<br />\n具体原因，可能是缺少 aml_autoscript 这个文件</p>\n<h3 id=\"进入安卓系统\"><a class=\"anchor\" href=\"#进入安卓系统\">#</a> 进入安卓系统</h3>\n<ol>\n<li>用 HDMI 连接显示器，直接的看到系统界面</li>\n<li>连接 WiFi 或者直接网线连接，获取 ip, 后面 N1 U 盘启动脚本，要用到。</li>\n<li>安装 reboot_update.apk (看一些教程说会卡 logo, 之前没有刷机经验，就直接安装了，所以不清楚有没有效果，后来人可以先不装)</li>\n</ol>\n<h3 id=\"制作emuelec-31-u盘启动\"><a class=\"anchor\" href=\"#制作emuelec-31-u盘启动\">#</a> 制作 emuelec 3.1 U 盘启动</h3>\n<ol>\n<li>格式化 U 盘</li>\n<li>打开 Win32DiskImager</li>\n<li>选择要刷入的镜像，如 emuelec 3.1</li>\n<li>选择 U 盘</li>\n<li>写入</li>\n<li>成功后，点击 OK，弹出 U 盘。(因为 U 盘变成了启动盘，系统提示 U 盘有问题，不用管直接关掉)</li>\n</ol>\n<h3 id=\"n1-u盘启动-emuelec\"><a class=\"anchor\" href=\"#n1-u盘启动-emuelec\">#</a> N1 U 盘启动 emuelec</h3>\n<ol>\n<li>制作好的 U 盘，插入靠近 HDMI 口的 USB 接口。</li>\n<li>另一个 USB 接口，插入双公 USB 线，并且和电脑相连供电。(供不供电都可以自己尝试下，因为我就用了各种镜像，各种方式试过)</li>\n<li>通过 N1 U 盘启动脚本，点击 U 盘启动.bat, 根据提示输入 N1 的 ip，回车确认，开始重启。(这步很关键，因为连接了显示器，可以看到画面一直卡在 905d 的 logo 界面，或者 Recovery 界面。)</li>\n<li>成功进入 emuelec 系统。(第一次进入系统都要花点时间初始化)</li>\n<li>初始化之后断电，去掉 U 盘，去掉供电。再接电重启 N1 盒子待用。</li>\n</ol>\n<h3 id=\"制作coreelec-u盘启动盘\"><a class=\"anchor\" href=\"#制作coreelec-u盘启动盘\">#</a> 制作 CoreElec U 盘启动盘</h3>\n<p>重复 制作 emuelec 3.1 U 盘启动 的步骤，当然镜像换成 CoreElec 的，我直接用目前最新的镜像<br />\n Damenly 的 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0RhbWVubHkvY29yZWVsZWMvcmVsZWFzZXMv\">CoreELEC 20.1 for Phicomm N1</span></p>\n<h3 id=\"n1-u盘启动-coreelec-201\"><a class=\"anchor\" href=\"#n1-u盘启动-coreelec-201\">#</a> N1 U 盘启动 CoreElec 20.1</h3>\n<ol>\n<li>因为之前成功进入 emuelec，启动其他 U 盘系统就简单多了</li>\n<li>插上 CoreElec 的启动盘，依然是靠近 HDMI 口的 USB 接口，不用插供电</li>\n<li>通过 N1 U 盘启动脚本，重启。</li>\n<li>这次启动 CoreElec 就没有卡 Logo 了，成功进入系统。</li>\n<li>根据提示设置，记得开启 ssh 和 smb</li>\n</ol>\n<h3 id=\"写入emmc\"><a class=\"anchor\" href=\"#写入emmc\">#</a> 写入 emmc</h3>\n<p>到上一步其实已经 ok 了，盒子能通过不同启动 U 盘使用各自系统，方便自由。<br />\n也可以把系统写入 N1 emmc 里，就不用通过 U 盘启动了。<br />\n当然写入 emmc 后，系统不是安卓没有 adb，想改刷别的系统，依然可以用拆机短接救砖的办法或者 ddbr 方法 (没试过，这里记录下)<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9sdW90aWFueWkudmMvMTM0Ni5odG1sL2NvbW1lbnQtcGFnZS0x\"> 使用 ddbr 恢复官改系统</span></p>\n<p>参考链接</p>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNzg3MjQzNDg=\">https://zhuanlan.zhihu.com/p/378724348</span></li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 使用 ssh 工具 (PuTTY、SecureCRT 等) 远程连接 ssh root@&lt;N1 的 ip> 如下，</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 如果之前进入系统时，没有设置密码的话，默认密码是 coreelec,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">ssh</span> root@192.168.1.10</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 执行 /flash 目录下的命令 写入 emmc</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>/flash/installtoemmc</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 第一个选 yes 剩下的全部 y（执行完毕会自动重启）-> 重启后关机拔下 U 盘再次重启。如果一切顺利，此时盒子应该顺利从 EMMC 启动 Coreelec 了</span></pre></td></tr></table></figure><div class=\"note info\">\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucmlnaHQuY29tLmNuL2ZvcnVtL3RocmVhZC00MTI3MjE3LTEtMS5odG1s\">https://www.right.com.cn/forum/thread-4127217-1-1.html</span><br />\n 本来是按照 Damenly 提供的脚本，想写入 emmc，结果抄作业失败了。</p>\n</div>\n<h2 id=\"部分工具保存到github\"><a class=\"anchor\" href=\"#部分工具保存到github\">#</a> 部分工具保存到 github</h2>\n<p>国内访问 cdn 地址 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jZG4uc3RhdGljYWx5LmNvbS9naC9hbWJlcjZodWEvY2RuQG1hc3Rlci9uMS8=\">https://cdn.staticaly.com/gh/amber6hua/cdn@master/n1/</span>&lt;跟文件名&gt;</p>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FtYmVyNmh1YS9jZG4vdHJlZS9tYXN0ZXIvbjE=\">https://github.com/amber6hua/cdn/tree/master/n1</span></li>\n</ul>\n",
            "tags": [
                "教程",
                "教程"
            ]
        },
        {
            "id": "https://amber6hua.github.io/linux/vbox-openwrt/",
            "url": "https://amber6hua.github.io/linux/vbox-openwrt/",
            "title": "Vbox虚拟机Docker安装Openwrt",
            "date_published": "2023-08-30T06:21:29.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>之前就好奇什么是软路由旁路由，但是没有设备<br />\n正好看见通过 Docker 安装 Openwrt 的文章，跟着动手学习下</p>\n<h2 id=\"我的基本环境\"><a class=\"anchor\" href=\"#我的基本环境\">#</a> 我的基本环境</h2>\n<p>matebook<br />\nVBox 虚拟机 ubuntu 镜像<br />\n网路设置<br />\n连接方式： 桥接网卡<br />\n网卡： WIFI 6<br />\n 混杂模式： 全部允许</p>\n<h2 id=\"开启网卡混杂模式\"><a class=\"anchor\" href=\"#开启网卡混杂模式\">#</a> 开启网卡混杂模式</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查看网卡名称，如我的是 enp0s3</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ifconfig</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 开启网卡混杂模式 </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">ip</span> <span class=\"token function\">link</span> <span class=\"token builtin class-name\">set</span> enp0s3 promisc on</pre></td></tr></table></figure><h2 id=\"开启-ipv4-转发\"><a class=\"anchor\" href=\"#开启-ipv4-转发\">#</a> 开启 ipv4 转发</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /etc/sysctl.conf </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#添加 net.ipv4.ip_forward = 1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sysctl -p /etc/sysctl.conf</pre></td></tr></table></figure><h2 id=\"配置macvlan模式的docker网络\"><a class=\"anchor\" href=\"#配置macvlan模式的docker网络\">#</a> 配置 macvlan 模式的 Docker 网络</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># --subnet=192.168.1.0/24   #填入宿主机网段</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># --gateway=192.168.1.1     #网关</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># parent=eth0    #宿主机 192.168.1.0/24 所使用的网卡</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>docker network create -d macvlan --subnet<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.1.0/24 --gateway<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.1.1 -o <span class=\"token assign-left variable\">parent</span><span class=\"token operator\">=</span>enp0s3 macnet</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 查看是否创建成功</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>docker network <span class=\"token function\">ls</span></pre></td></tr></table></figure><h2 id=\"创建网络配置文件\"><a class=\"anchor\" href=\"#创建网络配置文件\">#</a> 创建网络配置文件</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> -p /home/docker/openwrt</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vi</span> /home/docker/openwrt/network</pre></td></tr></table></figure><p>network 配置文件如下</p>\n<p>其中修改 ipaddr，gateway，dns 为需要的地址。</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>config interface 'loopback'</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        option ifname 'lo'</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        option proto 'static'</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        option ipaddr '127.0.0.1'</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        option netmask '255.0.0.0'</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>config globals 'globals'</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        option packet_steering '1'</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>config interface 'lan'</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">#option type 'bridge'</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        option ifname 'eth0'</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        option proto 'static'</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        option netmask '255.255.255.0'</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        option ip6assign '60'</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        option ipaddr '192.168.1.147'</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        option gateway '192.168.1.1'</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        option dns '192.168.1.1'</pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>config interface 'vpn0'</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        option ifname 'tun0'</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        option proto 'none'</pre></td></tr></table></figure><h2 id=\"拉取镜像并初始化\"><a class=\"anchor\" href=\"#拉取镜像并初始化\">#</a> 拉取镜像并初始化</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># --privileged 使用该参数，container 内的 root 拥有真正的 root 权限。否则，container 内的 root 只是外部的一个普通用户权限。privileged 启动的容器，可以看到很多 host 上的设备，并且可以执行 mount。甚至允许你在 docker 容器中启动 docker 容器。</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># --network 刚刚创建的 macvlan 网络  </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># --ip 不冲突的 IP 地址  </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># -v 映射目录 （这里映射的是网络配置）</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># openwrt 镜像选择 nonnichen/nonniwrt 或 piaoyizy/openwrt-x86</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>docker run --restart always --name openwrt -d --network macnet --privileged --ip <span class=\"token number\">192.168</span>.1.147  -v /home/docker/openwrt/network:/etc/config/network nonnichen/nonniwrt /sbin/init</pre></td></tr></table></figure><h2 id=\"操作容器\"><a class=\"anchor\" href=\"#操作容器\">#</a> 操作容器</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 进入容器</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docker <span class=\"token builtin class-name\">exec</span> -it openwrt <span class=\"token function\">bash</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 编辑网络 （初始化容器时可以忽略映射网络配置目录，自己编辑网络）</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">vi</span> /etc/config/network</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 重启网卡</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>/etc/init.d/network restart</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 修改密码命令（初始密码一般是 password, 可以根据需要修改）</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">passwd</span></pre></td></tr></table></figure><h2 id=\"访问openwrt\"><a class=\"anchor\" href=\"#访问openwrt\">#</a> 访问 openwrt</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMS4xNDc=\">http://192.168.1.147</span> （前面配置的容器 ip）<br />\n默认用户名：root<br />\n 默认密码：password</p>\n<h2 id=\"无线网卡-macvlan-组合有问题\"><a class=\"anchor\" href=\"#无线网卡-macvlan-组合有问题\">#</a> 无线网卡 + macvlan 组合有问题</h2>\n<p>虽然 openwrt 成功安装，但是发现容器内无法 ping 通网关，无法访问外网，可以 ping 通物理机<br />\n因为对 openwrt 和 macvlan 半懂不懂，只能边查询边配置，如 openwrt 中，不勾选桥接，防火墙规则等等，结果都不行</p>\n<p>最后发现可能是无线网卡 + macvlan 组合的问题，由于用的笔记本只能用无线网卡，且只有 wifi 连接，没法继续测试。</p>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc2Fvbml1aHVvLmNvbS9xdWVzdGlvbi9kZXRhaWwtMjM3MTI1My5odG1s\">https://www.saoniuhuo.com/question/detail-2371253.html</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9oaWN1LmJlL21hY3ZsYW4tdnMtaXB2bGFu\">https://hicu.be/macvlan-vs-ipvlan</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTY5MDA4NTcvZG9ja2VyLW5ldHdvcmstbWFjdmxhbi1kcml2ZXItZ2F0ZXdheS11bnJlYWNoYWJsZS81NjkxODQ1NyM1NjkxODQ1Nw==\">https://stackoverflow.com/questions/56900857/docker-network-macvlan-driver-gateway-unreachable/56918457#56918457</span></li>\n</ul>\n<p>看了上面的问题答案，于是尝试使用 ipvlan，并且初始化一个轻型容器 busybox，发现可以正常 ping 通网关，访问外网</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">## 创建 ipvlan </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docker network create -d ipvlan --subnet <span class=\"token number\">192.168</span>.1.0/24 -o <span class=\"token assign-left variable\">ipvlan_mode</span><span class=\"token operator\">=</span>l2 -o <span class=\"token assign-left variable\">parent</span><span class=\"token operator\">=</span>enp0s3 ipvlan</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">## 初始化容器</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>docker run --net<span class=\"token operator\">=</span>ipvlan --ip<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.1.145 -id --name c1 busybox <span class=\"token function\">sh</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">## 进入容器</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>docker <span class=\"token builtin class-name\">exec</span> -it c1 <span class=\"token function\">sh</span></pre></td></tr></table></figure><p>最后修改网络配置，重新初始化了一个关联 ipvlan 的 openwrt 容器<br />\n这里注释了 option type 'bridge'，因为关联 ipvlan 网络时，发现类型为桥接时，网络配置失败</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>config interface 'loopback'</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        option device 'lo'</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        option proto 'static'</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        option ipaddr '127.0.0.1'</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        option netmask '255.0.0.0'</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>config globals 'globals'</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        option packet_steering '1'</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>config interface 'lan'</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">#option type 'bridge'</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        option ifname 'eth0'</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        option proto 'static'</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        option ipaddr '192.168.1.147'</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        option ipv6 '0'</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        option netmask '255.255.255.0'</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        option gateway '192.168.1.1'</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        option dns '192.168.1.1'</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker run --restart always --name openwrt -d --network ipvlan --privileged --ip <span class=\"token number\">192.168</span>.1.147  -v /home/docker/openwrt/network:/etc/config/network nonnichen/nonniwrt /sbin/init</pre></td></tr></table></figure><h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81NjU1MjA3NjA=\">https://zhuanlan.zhihu.com/p/565520760</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9kN2ZiYmQxNjUwNTI=\">https://www.jianshu.com/p/d7fbbd165052</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY2ZtZW0uY29tLzIwMjEvMDgvZG9ja2VyLW9wZW53cnQuaHRtbCNnb29nbGVfdmlnbmV0dGU=\">https://www.cfmem.com/2021/08/docker-openwrt.html#google_vignette</span></li>\n</ul>\n",
            "tags": [
                "Linux",
                "教程",
                "Linux"
            ]
        },
        {
            "id": "https://amber6hua.github.io/linux/aria2-rclone/",
            "url": "https://amber6hua.github.io/linux/aria2-rclone/",
            "title": "Aria2 + Rclone 远程主机下载并上传OneDrive",
            "date_published": "2023-08-16T06:03:48.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>Play With Docker 是 Dockers hub 提供的免费的远程主机，并且自带 docker 环境，方便用户安装 docker 容器并测试，<br />\n之前申请的微软 E5 OneDrive 有 5T 空间，说实话空间虽然大，但是在国内访问速度太慢<br />\n于是尝试在这个白嫖的远程主机中安装 Aria2 + Rclone，下载资源并上传到 OneDrive 中</p>\n<h2 id=\"基本环境和工具\"><a class=\"anchor\" href=\"#基本环境和工具\">#</a> 基本环境和工具</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sYWJzLnBsYXktd2l0aC1kb2NrZXIuY29t\">Play With Docker</span> 远程主机</li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1AzVEVSWC9hcmlhMi5zaA==\">Aria2 下载工具</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yY2xvbmUub3Jn\">Rclone 挂载工具</span></li>\n<li><a href=\"portal.azure.com\">OneDrive 云存储</a></li>\n</ul>\n<h2 id=\"登录远程主机\"><a class=\"anchor\" href=\"#登录远程主机\">#</a> 登录远程主机</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sYWJzLnBsYXktd2l0aC1kb2NrZXIuY29t\">Play With Docker</span> 远程主机，在浏览器上无法使用复制粘贴功能，可以用本地主机 ssh 登录。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># ssh 登录远程主机</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ssh</span> ***@direct.labs.play-with-docker.com</pre></td></tr></table></figure><div class=\"note info\">\n<p>需要注意该远程主机的空间</p>\n</div>\n<h2 id=\"安装rclone\"><a class=\"anchor\" href=\"#安装rclone\">#</a> 安装 rclone</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 安装拓展工具</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>apk <span class=\"token function\">add</span> <span class=\"token function\">wget</span> <span class=\"token function\">curl</span> ca-certificates fuse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 下载 Rclone</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">wget</span> https://downloads.rclone.org/v1.61.1/rclone-v1.61.1-linux-amd64.zip</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">unzip</span> rclone-*-linux-amd64.zip</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin class-name\">cd</span> rclone-*-linux-amd64</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">cp</span> rclone /usr/bin/</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">chown</span> root:root /usr/bin/rclone</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token number\">755</span> /usr/bin/rclone</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">mkdir</span> -p /usr/local/share/man/man1</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">cp</span> rclone.1 /usr/local/share/man/man1/</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>mandb</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># 创建 rclone 的挂载 OneDrive 节点（可以忽略）</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">mkdir</span> /usr/local/onedrive</pre></td></tr></table></figure><h2 id=\"安装aria2\"><a class=\"anchor\" href=\"#安装aria2\">#</a> 安装 Aria2</h2>\n<p>下载 aria2.sh 完成后，执行脚本，根据选项进行安装</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> -N git.io/aria2.sh <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">chmod</span> +x aria2.sh <span class=\"token operator\">&amp;&amp;</span> ./aria2.sh</pre></td></tr></table></figure><p>默认安装成功后</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Aria2 简单配置信息：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token key atrule\">IPv4 地址</span>      <span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token key atrule\">IPv6 地址</span>      <span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token key atrule\">RPC 端口</span>       <span class=\"token punctuation\">:</span> <span class=\"token number\">6800</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token key atrule\">RPC 密钥</span>       <span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token key atrule\">下载目录</span>       <span class=\"token punctuation\">:</span> /root/downloads</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> AriaNg 链接    <span class=\"token punctuation\">:</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>注意：此时 aria2 只能正常下载<br />\n如需要下载并上传需要修改配置 .aria2c/aria2.conf<br />\n 下载完成后执行的命令 原先的配置是 /root/.aria2c/clean.sh 需要修改成 upload.sh 才能上传<br />\n on-download-complete=/root/.aria2c/upload.sh</p>\n<p>并且之前绑定的 Rclone name 需要和 /root/.aria2c/script.conf 中的配置对应<br />\n网盘名称 (RCLONE 配置时填写的 name)<br />\ndrive-name=OneDrive<br />\n 修改配置后需要重启 aria2 服务，可参考 进阶 Aria2c 命令行方式</p>\n</div>\n<h3 id=\"安装ariang\"><a class=\"anchor\" href=\"#安装ariang\">#</a> 安装 AriaNG</h3>\n<p>Aria2 没有图形化界面，需要安装 AriaNG，因为当前远程主机有 docker 环境，可以直接用 docker 安装，<br />\n访问 主机地址：6880 进入配置页面<br />\n然后根据上面的信息配置，配置 AriaNG，注意白嫖的远程主机的地址，配置好 RPC, 就可以使用了。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker run -d <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    --name ariang <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    --restart unless-stopped <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    --log-opt max-size<span class=\"token operator\">=</span>1m <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    -p <span class=\"token number\">6880</span>:6880 <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    p3terx/ariang</pre></td></tr></table></figure><h2 id=\"进阶aria2c-命令行方式\"><a class=\"anchor\" href=\"#进阶aria2c-命令行方式\">#</a> 进阶 Aria2c 命令行方式</h2>\n<p>准备</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 复制一个新的配置文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">cp</span> .aria2c/aria2.conf .aria2c/aria3.conf</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 修改配置 必须注释 aria2.session，因为命令行方式，直接输入下载链接参数</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">vi</span> .aria2c/aria3.conf</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 从会话文件中读取下载任务</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#input-file=/root/.aria2c/aria2.session</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># Aria2 退出时或指定的时间间隔会保存 `错误 / 未完成` 的下载任务到会话文件</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#save-session=/root/.aria2c/aria2.session</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># 下载完成后执行的命令 原先的配置是 /root/.aria2c/clean.sh 需要修改成 upload.sh 才能上传</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>on-download-complete<span class=\"token operator\">=</span>/root/.aria2c/upload.sh</pre></td></tr></table></figure><p>编辑 script.conf<br />\nvi /root/.aria2c/script.conf</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 编辑 script.conf</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vi</span> /root/.aria2c/script.conf</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 网盘名称 (RCLONE 配置时填写的 name)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>drive-name<span class=\"token operator\">=</span>OneDrive</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 注意 Rclone 配置时 name 必须相同</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>Current remotes:</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>Name                 Type</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">==</span>                 <span class=\"token operator\">==</span><span class=\"token operator\">==</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>OneDrive             onedrive</pre></td></tr></table></figure><p>命令行示例</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># --conf-path 读取配置文件</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># -D 守护进程</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># -S *.torrent 获取种子列表</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># --select-file=1,4-7 *.torrent 选择要下载内容 如：1，4，5，6，7</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 避免冲突，先把之前启动的 aria2 关闭，可以通过./aria2.sh 脚本关闭，也可以 kill &lt;pid></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 查找 aria2 的 pid</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">ps</span> -ef <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> aria2</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">kill</span> <span class=\"token operator\">&lt;</span>pid<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># aria2c 命令行示例， 测试是否能够正常下载上传</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>aria2c --conf-path<span class=\"token operator\">=</span>/root/.aria2c/aria3.conf <span class=\"token string\">'https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png'</span></pre></td></tr></table></figure><h2 id=\"rclone-挂载onedrive\"><a class=\"anchor\" href=\"#rclone-挂载onedrive\">#</a> Rclone 挂载 OneDrive</h2>\n<blockquote>\n<p>参考地址 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81NTg3MzAwNy9hcnRpY2xlL2RldGFpbHMvMTI2NTgxMzI4\">https://blog.csdn.net/weixin_55873007/article/details/126581328</span></p>\n</blockquote>\n<ul>\n<li>首先 OneDrive 需要注册应用（其中选择 web 填写 <span class=\"exturl\" data-url=\"aHR0cDovL2xvY2FsaG9zdDo1MzY4Mg==\">http://localhost:53682</span>），并创建密钥</li>\n<li>获得 client_id 和 client_secret 后，通过 rclone 获得 token</li>\n<li>如果 Rclone 所在的宿主机自带图像化界面和浏览器，则可以根据 rclone config，一步步配置</li>\n<li>否则也可以其他带浏览器的机器上，如果 windows 也下载个 rclone.exe 获得 token, 复制到宿主机中</li>\n<li>注意：之前下载最新版本的 rclone, 挂载过程中遇 fuse 问题，看讨论需要 fuse3, 没搞好</li>\n<li>于是下载 v1.16.1 版本，正常挂载</li>\n<li>如果单纯为了把 aria2 的下载内容上传到 OneDrive 中，rclone mount 步骤可以省略</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 挂载到 /usr/local/onedrive</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>rclone <span class=\"token function\">mount</span> OneDrive:/ /usr/local/onedrive --allow-other --allow-non-empty --vfs-cache-mode writes <span class=\"token operator\">&amp;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 取消挂载</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>fusermount -u /usr/local/onedrive</pre></td></tr></table></figure><h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wM3RlcnguY29tL2FyY2hpdmVzL29mZmxpbmUtZG93bmxvYWQtb2Ytb25lZHJpdmUtZ2RyaXZlLmh0bWw=\">https://p3terx.com/archives/offline-download-of-onedrive-gdrive.html</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81NTg3MzAwNy9hcnRpY2xlL2RldGFpbHMvMTI2NTgxMzI4\">https://blog.csdn.net/weixin_55873007/article/details/126581328</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9yY2xvbmUub3JnL2NvbW1hbmRzL3JjbG9uZV9tb3VudC8=\">https://rclone.org/commands/rclone_mount/</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmx1ZXNreXhuLmNvbS8yMDIyMDkvNjUxMC5odG1s\">https://www.blueskyxn.com/202209/6510.html</span></li>\n</ul>\n",
            "tags": [
                "Linux",
                "教程",
                "Linux"
            ]
        },
        {
            "id": "https://amber6hua.github.io/fastadmin/fastadmin-doc-13/",
            "url": "https://amber6hua.github.io/fastadmin/fastadmin-doc-13/",
            "title": "FastAdmin 个人记录 - 自定义字段排序",
            "date_published": "2023-05-30T02:31:21.000Z",
            "content_html": "<blockquote>\n<p>fastadmin 默认排序字段是 weigh, 方法是 ajax/weigh<br />\n 这里以自定义字段 sort 为例</p>\n</blockquote>\n<h2 id=\"根据需要添加对应控制器方法或改写ajaxweigh-修改todo处\"><a class=\"anchor\" href=\"#根据需要添加对应控制器方法或改写ajaxweigh-修改todo处\">#</a> 根据需要添加对应控制器方法或改写 ajax/weigh 修改 TODO 处</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">protected</span> <span class=\"token variable\">$noNeedRight</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'weigh'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     * 通用排序</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">weigh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 排序的数组</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token variable\">$ids</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ids\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 拖动的记录 ID</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$changeid</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"changeid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">// 操作字段</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token variable\">$field</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"field\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">// 操作的数据表</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token variable\">$table</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"table\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token class-name static-context\">Validate</span><span class=\"token operator\">::</span><span class=\"token function\">is</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$table</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"alphaDash\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\">// 主键</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token variable\">$pk</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"pk\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// 排序的方式</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token variable\">$orderway</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"orderway\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token variable\">$orderway</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$orderway</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'asc'</span> <span class=\"token operator\">?</span> <span class=\"token string single-quoted-string\">'ASC'</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'DESC'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$sour</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$weighdata</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$ids</span> <span class=\"token operator\">=</span> <span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">','</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ids</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token variable\">$prikey</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$pk</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^[a-z0-9\\-_]+$/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$pk</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$pk</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$table</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getPk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token variable\">$pid</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"pid\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token comment\">//TODO 限制更新的字段</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token variable\">$field</span> <span class=\"token operator\">=</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$field</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'weigh'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token comment\">// 如果设定了 pid 的值，此时只匹配满足条件的 ID, 其它忽略</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$pid</span> <span class=\"token operator\">!==</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token variable\">$hasids</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token variable\">$list</span> <span class=\"token operator\">=</span> <span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$table</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prikey</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'in'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ids</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'pid'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'in'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$pid</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">field</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$prikey</span><span class=\"token punctuation\">&#125;</span></span>,pid\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$list</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$k</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token variable\">$hasids</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$prikey</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token variable\">$ids</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_values</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_intersect</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ids</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$hasids</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token variable\">$list</span> <span class=\"token operator\">=</span> <span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$table</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">field</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$prikey</span></span>,<span class=\"token interpolation\"><span class=\"token variable\">$field</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prikey</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'in'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ids</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">order</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$orderway</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$list</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$k</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token variable\">$sour</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$prikey</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token variable\">$weighdata</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$v</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$prikey</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token variable\">$position</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_search</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$changeid</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ids</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token variable\">$desc_id</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sour</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$position</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$sour</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$position</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sour</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// 移动到目标的 ID 值，取出所处改变前位置的值</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token variable\">$sour_id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$changeid</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token variable\">$weighids</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token variable\">$temp</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_values</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_diff_assoc</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ids</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sour</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$temp</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$m</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$n</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$n</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$sour_id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                <span class=\"token variable\">$offset</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$desc_id</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$sour_id</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$temp</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                    <span class=\"token variable\">$offset</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$temp</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$m</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$temp</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$m</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token variable\">$sour_id</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                    <span class=\"token variable\">$offset</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$temp</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$m</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$temp</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$m</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token variable\">$sour_id</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$weighdata</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$offset</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            <span class=\"token variable\">$weighids</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$n</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$weighdata</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$offset</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            <span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$table</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prikey</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$n</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$field</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$weighdata</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$offset</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"对应控制器js-定义自定义字段排序\"><a class=\"anchor\" href=\"#对应控制器js-定义自定义字段排序\">#</a> 对应控制器 js - 定义自定义字段排序</h2>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 初始化表格参数配置</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            Table<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                extend<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                    <span class=\"token comment\">//...</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                    dragsort_url<span class=\"token operator\">:</span> <span class=\"token string\">'control/tutorial/weigh'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                    table<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            Table<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>dragsortfield <span class=\"token operator\">=</span> <span class=\"token string\">'sort'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token comment\">// 省略</span></pre></td></tr></table></figure><h2 id=\"对应model-添加记录时如果未设置排序自动赋值\"><a class=\"anchor\" href=\"#对应model-添加记录时如果未设置排序自动赋值\">#</a> 对应 model - 添加记录时，如果未设置排序，自动赋值</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">protected</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword static-context\">self</span><span class=\"token operator\">::</span><span class=\"token function\">afterInsert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token variable\">$pk</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$row</span><span class=\"token operator\">-></span><span class=\"token function\">getPk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token variable\">$row</span><span class=\"token operator\">-></span><span class=\"token function\">getQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$pk</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$pk</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$pk</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "FastAdmin",
                "教程",
                "FastAdmin"
            ]
        },
        {
            "id": "https://amber6hua.github.io/docker-cloud-pc/",
            "url": "https://amber6hua.github.io/docker-cloud-pc/",
            "title": "Play With Docker 白嫖个人云电脑",
            "date_published": "2023-05-25T07:08:16.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>利用 docker hub 提供的 Play With Docker 白嫖一个可以访问外网的个人云电脑</p>\n<h2 id=\"转发自\"><a class=\"anchor\" href=\"#转发自\">#</a> 转发自</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmlkYXJpYW4uY29tL2t1YWktc3UtY2h1YW5nLWppYW4tbWlhbi1mZWktZ2UtcmVuLXl1bi1kaWFuLW5hby1rZS15b25nLXl1LXpodS1jZS16aGFuZy1oYW8tZGVuZw==\">https://blog.idarian.com/kuai-su-chuang-jian-mian-fei-ge-ren-yun-dian-nao-ke-yong-yu-zhu-ce-zhang-hao-deng</span></p>\n<h2 id=\"摘要\"><a class=\"anchor\" href=\"#摘要\">#</a> 摘要</h2>\n<p>注册 Dockre 账号并登录 Play With Docker，复制粘贴以下代码，创建一个名为 ubuntu-xfce-vnc 的容器，设置密码为 shopifyisfine，打开 6666 端口即可登录。注意每次登录限时四小时。</p>\n<h2 id=\"1注册账号\"><a class=\"anchor\" href=\"#1注册账号\">#</a> 1. 注册账号</h2>\n<p>首先，<span class=\"exturl\" data-url=\"aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS9zaWdudXA=\">注册一个免费 Dockre 账号</span>，用户登陆创建实例</p>\n<h2 id=\"2-登陆使用\"><a class=\"anchor\" href=\"#2-登陆使用\">#</a> 2. 登陆使用</h2>\n<p>注册完之后，登录 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sYWJzLnBsYXktd2l0aC1kb2NrZXIuY29tLw==\">Play With Docker</span>，一步步复制粘贴即可。<br />\n提示：为避免资源滥用，每次登录限时四小时，用于注册账号和浏览网页足够。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> /root/ubuntu <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> /root/ubuntu</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>apk <span class=\"token function\">add</span> <span class=\"token function\">nano</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">nano</span> docker-compose.yml</pre></td></tr></table></figure><figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.5'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">ubuntu-xfce-vnc</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> xfce</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> imlala/ubuntu<span class=\"token punctuation\">-</span>xfce<span class=\"token punctuation\">-</span>vnc<span class=\"token punctuation\">-</span>novnc<span class=\"token punctuation\">:</span>latest</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">shm_size</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2gb\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> 5555<span class=\"token punctuation\">:</span><span class=\"token number\">5900</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">-</span> 6666<span class=\"token punctuation\">:</span><span class=\"token number\">6080</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">-</span> VNC_PASSWD=shopifyisfine</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> GEOMETRY=1920x1080</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">-</span> DEPTH=24</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">-</span> ./Downloads<span class=\"token punctuation\">:</span>/root/Downloads</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</pre></td></tr></table></figure><p>提示：粘贴之后按 Ctrl + X，再按 Y，接着按回车键进行保存</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>docker-compose up -d</pre></td></tr></table></figure><p>打开 6666 端口，登录密码： shopifyisfine</p>\n<h2 id=\"进阶\"><a class=\"anchor\" href=\"#进阶\">#</a> 进阶</h2>\n<p>由于控制台无法复制，一行行打代码也麻烦，可以把 docker-compose.yml 保存到自己的 github 项目中，通过 wget 下载</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">## 下载 docker-compose.yml</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">wget</span> https://github.com/amber6hua/cdn/raw/master/docker/ubuntu/docker-compose.yml</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>docker-compose up -d</pre></td></tr></table></figure>",
            "tags": [
                "教程",
                "docker",
                "教程",
                "docker"
            ]
        },
        {
            "id": "https://amber6hua.github.io/onedrive-vercel-index/",
            "url": "https://amber6hua.github.io/onedrive-vercel-index/",
            "title": "Onedrive Vercel Index 记录部署大致流程",
            "date_published": "2023-04-19T07:10:04.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>heroku 不让白嫖了<br />\n换 Vercel 继续白嫖</p>\n<h2 id=\"项目地址\"><a class=\"anchor\" href=\"#项目地址\">#</a> 项目地址</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwZW5jZXJ3b29vL29uZWRyaXZlLXZlcmNlbC1pbmRleC8=\">Onedrive Vercel Index</span></p>\n<h2 id=\"部署\"><a class=\"anchor\" href=\"#部署\">#</a> 部署</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9vdmkuc3dvLm1vZS9kb2NzL2dldHRpbmctc3RhcnRlZA==\">部署文档</span></p>\n<ul>\n<li>\n<p>fork 项目</p>\n</li>\n<li>\n<p>修改 config/site.config.js</p>\n<ul>\n<li>userPrincipleName 修改成自己 onedrive 账户</li>\n<li>baseDirectory 修改成需要展示的目录， 值为 / 表示展示全部</li>\n<li>(也可以在 vercel 对应项目的 setting 下 设置 Environment Variables)</li>\n</ul>\n</li>\n<li>\n<p>注册 <span class=\"exturl\" data-url=\"aHR0cHM6Ly92ZXJjZWwuY29tLw==\">Vercel</span> 成功后，导入刚刚 fork 的项目</p>\n</li>\n<li>\n<p>进入 setting 设置 Environment Variables</p>\n<ul>\n<li>添加 REDIS_URL</li>\n</ul>\n</li>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly92ZXJjZWwuY29tL2ludGVncmF0aW9ucw==\">Vercel Integrations</span> 提供免费 redis 服务 <span class=\"exturl\" data-url=\"aHR0cHM6Ly92ZXJjZWwuY29tL2ludGVncmF0aW9ucy91cHN0YXNo\">upstash</span></p>\n<ul>\n<li>add Integrations 并进入 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb25zb2xlLnVwc3Rhc2guY29tLw==\">upstash 控制台</span></li>\n<li>创建一个实例</li>\n<li>复制 redis:// 。。。 到 REDIS_URL</li>\n<li>注意如果勾选 ssl 则地址开头为 rediss://:</li>\n</ul>\n</li>\n<li>\n<p>重新加载后进入 Onedrive Vercel Index</p>\n</li>\n<li>\n<p>配置正确的情况下，会得到怎么绑定 onedrive 的页面，根据提示操作</p>\n</li>\n</ul>\n",
            "tags": [
                "教程",
                "教程"
            ]
        },
        {
            "id": "https://amber6hua.github.io/fastadmin/fastadmin-doc-12/",
            "url": "https://amber6hua.github.io/fastadmin/fastadmin-doc-12/",
            "title": "FastAdmin 个人记录 - 自定义搜索渲染",
            "date_published": "2023-03-03T02:31:21.000Z",
            "content_html": "<h2 id=\"单个字段自定义搜索渲染\"><a class=\"anchor\" href=\"#单个字段自定义搜索渲染\">#</a> 单个字段自定义搜索渲染</h2>\n<blockquote>\n<p>selectpage 搜索 例：customerID 按需替换</p>\n</blockquote>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 在普通搜索渲染后</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            table<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post-common-search.bs.table'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> table</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token keyword\">var</span> form <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"form\"</span><span class=\"token punctuation\">,</span> table<span class=\"token punctuation\">.</span>$commonsearch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input[name='customerID']\"</span><span class=\"token punctuation\">,</span> form<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"selectpage\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"source\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"customer/customer/index\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"primaryKey\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"field\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"charname\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"orderBy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"id desc\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                Form<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">cxselect</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                Form<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">selectpage</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>等于排除 搜索 例：mid 按需替换</p>\n</blockquote>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 在普通搜索渲染后</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            table<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post-common-search.bs.table'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> table</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token keyword\">var</span> form <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"form\"</span><span class=\"token punctuation\">,</span> table<span class=\"token punctuation\">.</span>$commonsearch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token keyword\">let</span> html <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;!--显式的operate操作符-->\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                    <span class=\"token string\">'                        &lt;div class=\"input-group\">\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                    <span class=\"token string\">'                            &lt;div class=\"input-group-btn\">\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token string\">'                                &lt;select class=\"form-control operate\" data-name=\"mid\" style=\"width:60px;\">\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                    <span class=\"token string\">'                                    &lt;option value=\"=\" selected>等于&lt;/option>\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                    <span class=\"token string\">'                                    &lt;option value=\"&lt;>\">排除&lt;/option>\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                    <span class=\"token string\">'                                &lt;/select>\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                    <span class=\"token string\">'                            &lt;/div>\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                    <span class=\"token string\">'                            &lt;input class=\"form-control\" type=\"text\" name=\"mid\" id=\"mid\" placeholder=\"\" value=\"\"/>\\n'</span> <span class=\"token operator\">+</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    <span class=\"token string\">'                        &lt;/div>'</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input[name='mid']\"</span><span class=\"token punctuation\">,</span> form<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"开发示例-自定义搜索表单模板-searchformtemplate\"><a class=\"anchor\" href=\"#开发示例-自定义搜索表单模板-searchformtemplate\">#</a> 开发示例 自定义搜索表单模板 searchFormTemplate</h2>\n<blockquote>\n<p>searchFormTemplate</p>\n</blockquote>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>table<span class=\"token punctuation\">.</span><span class=\"token function\">bootstrapTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                <span class=\"token operator\">...</span>省略</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                searchFormVisible<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                searchFormTemplate<span class=\"token operator\">:</span> <span class=\"token string\">'customformtpl'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                <span class=\"token operator\">...</span>省略</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>对应模板</p>\n</blockquote>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>customformtpl<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>form表单必须添加form<span class=\"token operator\">-</span>commsearch这个类<span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token operator\">&lt;</span>form action<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span> <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"form-commonsearch\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"border-radius:2px;margin-bottom:10px;background:#f5f5f5;padding:15px 20px;\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token operator\">&lt;</span>h4<span class=\"token operator\">></span>自定义搜索表单<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h4<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token operator\">&lt;</span>hr<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"row\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"col-xs-12 col-sm-6 col-md-3\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                    <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"form-group\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>label <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"control-label\"</span><span class=\"token operator\">></span><span class=\"token constant\">ID</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>显式的operate操作符<span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"input-group\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                            <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"input-group-btn\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                                <span class=\"token operator\">&lt;</span>select <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"form-control operate\"</span> data<span class=\"token operator\">-</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"id\"</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"width:60px;\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                                    <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"=\"</span> selected<span class=\"token operator\">></span>等于<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>option<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                                    <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\">\"</span><span class=\"token operator\">></span>大于<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>option<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                                    <span class=\"token operator\">&lt;</span>option value<span class=\"token operator\">=</span><span class=\"token string\">\"&lt;\"</span><span class=\"token operator\">></span>小于<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>option<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>select<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                            <span class=\"token operator\">&lt;</span>input <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"form-control\"</span> type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"id\"</span> placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span> value<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"col-xs-12 col-sm-6 col-md-3\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"form-group\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>label <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"control-label\"</span><span class=\"token operator\">></span>标题<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>隐式的operate操作符，必须携带一个<span class=\"token keyword\">class</span>为operate隐藏的文本框<span class=\"token punctuation\">,</span>且它的data<span class=\"token operator\">-</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"字段\"</span><span class=\"token punctuation\">,</span>值为操作符<span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>input <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"operate\"</span> type<span class=\"token operator\">=</span><span class=\"token string\">\"hidden\"</span> data<span class=\"token operator\">-</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"title\"</span> value<span class=\"token operator\">=</span><span class=\"token string\">\"=\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>input <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"form-control\"</span> type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"title\"</span> placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"请输入查找的标题\"</span> value<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"col-xs-12 col-sm-6 col-md-3\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                    <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"form-group\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>label <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"control-label\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                        <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"row\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                            <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"col-xs-6\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                                <span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string\">\"submit\"</span> <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"btn btn-success btn-block\"</span> value<span class=\"token operator\">=</span><span class=\"token string\">\"提交\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                            <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"col-xs-6\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                                <span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string\">\"reset\"</span> <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"btn btn-primary btn-block\"</span> value<span class=\"token operator\">=</span><span class=\"token string\">\"重置\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h2 id=\"表格自定义搜索拓展下拉搜索操作符\"><a class=\"anchor\" href=\"#表格自定义搜索拓展下拉搜索操作符\">#</a> 表格自定义搜索拓展，下拉搜索操作符</h2>\n<ul>\n<li>给表格 field，增加 operate: 'number' ，自定义搜索等于大于小于</li>\n<li>在 public/assets/js/bootstrap-table-commonsearch.js 新增 number 判断</li>\n</ul>\n<p>具体链接</p>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9hc2suZmFzdGFkbWluLm5ldC9hcnRpY2xlLzEwNzUzLmh0bWw=\">https://ask.fastadmin.net/article/10753.html</span></li>\n</ul>\n",
            "tags": [
                "FastAdmin",
                "教程",
                "FastAdmin"
            ]
        },
        {
            "id": "https://amber6hua.github.io/linux/docker-networks/",
            "url": "https://amber6hua.github.io/linux/docker-networks/",
            "title": "docker-compose.yml networks",
            "date_published": "2023-03-01T08:21:48.000Z",
            "content_html": "<h2 id=\"参考连接\"><a class=\"anchor\" href=\"#参考连接\">#</a> 参考连接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8zMDA0ZmJjZTRkMzc=\">https://www.jianshu.com/p/3004fbce4d37</span></li>\n</ul>\n<h2 id=\"默认网络\"><a class=\"anchor\" href=\"#默认网络\">#</a> 默认网络</h2>\n<p>docker-compose up 的时候，默认创建一个 以 _default 为后缀的默认网络</p>\n<p>docker-compose.yml 中的容器都属于默认网络</p>\n<h2 id=\"自定义网络\"><a class=\"anchor\" href=\"#自定义网络\">#</a> 自定义网络</h2>\n<p>可能通过一级配置 networks 来自定义网络，可以创建更复杂的网络选项和配置，也可以用来连接已经存在的网络（不是通过 compose 创建的）</p>\n<p>每个 service 配置下也可以指定 networks 配置，来指定一级配置的网络。</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">proxy</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./proxy</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">-</span> frontend</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./app</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">-</span> frontend</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">-</span> backend</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token key atrule\">db</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> postgres</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token punctuation\">-</span> backend</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token key atrule\">frontend</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token comment\"># Use a custom driver</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> custom<span class=\"token punctuation\">-</span>driver<span class=\"token punctuation\">-</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token comment\"># Use a custom driver which takes special options</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> custom<span class=\"token punctuation\">-</span>driver<span class=\"token punctuation\">-</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token key atrule\">driver_opts</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      <span class=\"token key atrule\">foo</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>      <span class=\"token key atrule\">bar</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2\"</span></pre></td></tr></table></figure><ol>\n<li>一级配置 networks 用来创建自定义的网络 。这里配置了两个 frontend 和 backend . 且自定义了网络类型。</li>\n<li>每一个 services 下，proxy , app , db 都定义了一下 networks 配置。\n<ul>\n<li>proxy 只加入到 frontend 网络。</li>\n<li>db 只加入到 backend 网络。</li>\n<li>app 同时加入到 frontend 和 backend 。</li>\n<li>db 和 proxy 不能通讯，因为不在一个网络中。</li>\n<li>app 和两个都能通讯，因为 app 在两个网络中都有配置。</li>\n<li>db 和 proxy 要通讯，只能通过 app 这个应用来连接。</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"设置默认网络\"><a class=\"anchor\" href=\"#设置默认网络\">#</a> 设置默认网络</h3>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\"># Use a custom driver</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> custom<span class=\"token punctuation\">-</span>driver<span class=\"token punctuation\">-</span><span class=\"token number\">1</span></pre></td></tr></table></figure><h3 id=\"指定一个已经存在的网络\"><a class=\"anchor\" href=\"#指定一个已经存在的网络\">#</a> 指定一个已经存在的网络</h3>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">external</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> frontend</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">frontend</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">external</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> backend</pre></td></tr></table></figure>",
            "tags": [
                "Linux",
                "Linux"
            ]
        },
        {
            "id": "https://amber6hua.github.io/linux/linux-php-switch/",
            "url": "https://amber6hua.github.io/linux/linux-php-switch/",
            "title": "Linux 宝塔面板多版本php切换",
            "date_published": "2023-02-02T06:52:44.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>虚拟机 Linux 中安装了宝塔面板，其中 PHP 可以安装多个版本，并且可以给对应站点选择对应 PHP 版本<br />\n不过用 shell 命令 php -v 查看 PHP 版本却不清楚怎么切换，这里记录下</p>\n<h2 id=\"宝塔默认安装php的目录\"><a class=\"anchor\" href=\"#宝塔默认安装php的目录\">#</a> 宝塔默认安装 php 的目录</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/www/server/php/71</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/www/server/php/72</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>/www/server/php/73</pre></td></tr></table></figure><h2 id=\"切换过程\"><a class=\"anchor\" href=\"#切换过程\">#</a> 切换过程</h2>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查看默认版本命令</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ls</span> -l /usr/bin/php</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 命令返回类似结果</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">26</span> <span class=\"token number\">7</span>月  <span class=\"token number\">12</span>  <span class=\"token number\">2022</span> /usr/bin/php -<span class=\"token operator\">></span> /www/server/php/71/bin/php</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 切换默认 PHP 版本命令 (通过软链接)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">ln</span> -sf /www/server/php/72/bin/php /usr/bin/php</pre></td></tr></table></figure>",
            "tags": [
                "Linux",
                "教程",
                "PHP",
                "Linux"
            ]
        },
        {
            "id": "https://amber6hua.github.io/fastadmin/fastadmin-doc-11/",
            "url": "https://amber6hua.github.io/fastadmin/fastadmin-doc-11/",
            "title": "FastAdmin 个人记录 - 引入vue",
            "date_published": "2023-01-13T03:10:58.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>直接都是直接下载包到项目里引入，看到 Fastadmin 框架里有 Bower， 了解到是一个针对 Web 开发的包管理器。<br />\n就尝试安装使用下。</p>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9hc2suZmFzdGFkbWluLm5ldC9hcnRpY2xlLzMxOTkyLmh0bWw=\">https://ask.fastadmin.net/article/31992.html</span></li>\n</ul>\n<h2 id=\"bower安装vue\"><a class=\"anchor\" href=\"#bower安装vue\">#</a> bower 安装 vue</h2>\n<ul>\n<li>因为我之前没有安装 bower 首先需要安装 npm install bower</li>\n<li>先打开项目根目录的 bower.json 文件，模仿已有 包名 + 版本 追加一行 &quot;vue&quot;: &quot;~2.6.14&quot;</li>\n<li>保存后， 执行 bower update</li>\n<li>因为框架有配置文件 .bowerrc, 会自动指定目录下载 public/assets/libs</li>\n</ul>\n<h2 id=\"引入vue\"><a class=\"anchor\" href=\"#引入vue\">#</a> 引入 vue</h2>\n<ul>\n<li>修改文件 public/assets/js.backend-init.js 内容如下 引入 vue</li>\n<li>执行 php think min -m all -r all 压缩 js，使 debug=false 也能使用</li>\n</ul>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'backend'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">Backend</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    require<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        paths<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token string\">'layui'</span><span class=\"token operator\">:</span> <span class=\"token string\">'../libs/layui/layui'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token string\">'vue'</span><span class=\"token operator\">:</span> <span class=\"token string\">'../libs/vue/dist/vue.min'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        shim<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token string\">'layui'</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                deps<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">'css!../libs/layui/css/layui.css'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                exports<span class=\"token operator\">:</span> <span class=\"token string\">\"layui\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"使用方法\"><a class=\"anchor\" href=\"#使用方法\">#</a> 使用方法</h2>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'jquery'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bootstrap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'backend'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'vue'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">$<span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> Backend<span class=\"token punctuation\">,</span> Vue</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">var</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        el<span class=\"token operator\">:</span> <span class=\"token string\">'#main'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token function-variable function\">created</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hello vue'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "FastAdmin",
                "教程",
                "FastAdmin"
            ]
        },
        {
            "id": "https://amber6hua.github.io/fastadmin/fastadmin-doc-10/",
            "url": "https://amber6hua.github.io/fastadmin/fastadmin-doc-10/",
            "title": "FastAdmin 个人记录 - 重构$where条件",
            "date_published": "2022-09-16T05:55:58.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<blockquote>\n<p>FastAdmin 中的 table 自定义搜索，有时候需要重构 where 条件<br />\n list ($where, $sort, $order, $offset, $limit) = $this-&gt;buildparams ();<br />\n 经过 buildparams 处理后不好修改<br />\n可以在 buildparams 之前处理<br />\n下面记录 php 和 js 两种处理方式</p>\n</blockquote>\n<h2 id=\"方式一-php\"><a class=\"anchor\" href=\"#方式一-php\">#</a> 方式一 php</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$filter</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"filter\"</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token variable\">$op</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"op\"</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'trim'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token variable\">$where0</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filter</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'groupIds'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                <span class=\"token comment\">// 自定义处理</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token comment\">// 处理完可以去掉也可以覆盖重构</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filter</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'groupIds'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$op</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'groupIds'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'filter'</span><span class=\"token operator\">=></span><span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filter</span><span class=\"token punctuation\">,</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'op'</span><span class=\"token operator\">=></span><span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$op</span><span class=\"token punctuation\">,</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"方式二-js\"><a class=\"anchor\" href=\"#方式二-js\">#</a> 方式二 js</h2>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>table<span class=\"token punctuation\">.</span><span class=\"token function\">bootstrapTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 省略...</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function-variable function\">queryParams</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">params</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">let</span> filter <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">let</span> op <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// 重构搜索条件</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        filter<span class=\"token punctuation\">[</span><span class=\"token string\">'game.game_mode'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        filter<span class=\"token punctuation\">[</span><span class=\"token string\">'game.play_mode'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        op<span class=\"token punctuation\">[</span><span class=\"token string\">'game.game_mode'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'='</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        op<span class=\"token punctuation\">[</span><span class=\"token string\">'game.play_mode'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'='</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        params<span class=\"token punctuation\">.</span>filter <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>filter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        params<span class=\"token punctuation\">.</span>op <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">return</span> params<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "FastAdmin",
                "教程",
                "FastAdmin"
            ]
        },
        {
            "id": "https://amber6hua.github.io/php-xdebug-phpstorm/",
            "url": "https://amber6hua.github.io/php-xdebug-phpstorm/",
            "title": "PhpStorm配置和使用Xdebug调试",
            "date_published": "2022-08-30T02:39:04.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>PhpStorm 里面的功能太多了，其中的调试功能也容易让人摸不着头脑<br />\n这里记录下 PhpStorm 配置和使用 xdebug 调试的过程</p>\n<blockquote>\n<p>参考链接</p>\n</blockquote>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamV0YnJhaW5zLmNvbS9oZWxwL3BocHN0b3JtL2RlYnVnZ2luZy13aXRoLXBocHN0b3JtLXVsdGltYXRlLWd1aWRlLmh0bWwjcXVpY2stc3RhcnQ=\">https://www.jetbrains.com/help/phpstorm/debugging-with-phpstorm-ultimate-guide.html#quick-start</span></li>\n</ul>\n<h2 id=\"准备工作\"><a class=\"anchor\" href=\"#准备工作\">#</a> 准备工作</h2>\n<ul>\n<li>php 安装 xdebug 拓展 (2.x 和 3.x 的配置有区别)</li>\n<li>浏览器安装 xdebug 插件 (以 chrome 为例，需要科学上网) <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwveGRlYnVnLWhlbHBlci9lYWRuZGZqcGxnaWVsZGpiaWdqYWttZGdrbW9hYWFvYw==\">Xdebug Helper</span></li>\n<li>PhpStorm (当前版本 2022.1.4 影响不大看个人)</li>\n</ul>\n<h2 id=\"phpini-xdebug配置\"><a class=\"anchor\" href=\"#phpini-xdebug配置\">#</a> php.ini Xdebug 配置</h2>\n<div class=\"tab\" data-id=\"id1\" data-title=\"Xdebug 2.x\">\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>xdebug<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">zend_extension</span><span class=\"token operator\">=</span><span class=\"token string\">\"&lt;path to xdebug extension>\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>xdebug.remote_enable<span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>xdebug.remote_host<span class=\"token operator\">=</span><span class=\"token number\">127.0</span>.0.1</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>xdebug.remote_port<span class=\"token operator\">=</span><span class=\"token string\">\"&lt;the port (9000 by default) to which Xdebug connects>\"</span></pre></td></tr></table></figure></div>\n<div class=\"tab\" data-id=\"id1\" data-title=\"Xdebug 3.x\">\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>xdebug<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">zend_extension</span><span class=\"token operator\">=</span><span class=\"token string\">\"&lt;path to xdebug extension>\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>xdebug.mode<span class=\"token operator\">=</span>debug</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>xdebug.client_host<span class=\"token operator\">=</span><span class=\"token number\">127.0</span>.0.1</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>xdebug.client_port<span class=\"token operator\">=</span><span class=\"token string\">\"&lt;the port (9003 by default) to which Xdebug connects>\"</span></pre></td></tr></table></figure></div>\n<blockquote>\n<p>以我的开发环境为例 xdebug 2.x (共享文件夹，本地目录映射虚拟机为例)<br />\n remote_host=192.168.0.* (个人 PC 的局域网 ip 地址)<br />\n remote_port=19000 (端口默认 9000) 可以自定义设置端口，只要不冲突就行</p>\n</blockquote>\n<div class=\"note info\">\n<p>额外参数介绍</p>\n<ul>\n<li>\n<p>开启 xdebug 时，默认 overload_var_dump=2，因为习我惯 var_dump () 默认的打印，可以设置 0 关掉<br />\n xdebug.overload_var_dump=0</p>\n</li>\n<li>\n<p>PhpStorm 支持在 Just-In-Time (JIT) 模式下使用 Xdebug, 默认 xdebug.remote_mode=req 一般情况不用设置<br />\n xdebug.remote_mode=jit</p>\n</li>\n<li>\n<p>通过 DBGP 代理进行<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuamV0YnJhaW5zLmNvbS9oZWxwL3BocHN0b3JtL211bHRpdXNlci1kZWJ1Z2dpbmctdmlhLXhkZWJ1Zy1wcm94aWVzLmh0bWwjdHJvdWJsZXNob290aW5n\">多用户调试</span><br />\n官网描述<br />\n xdebug.idekey 设置并为其指定一个您选择的值。此值将用于在 Xdebug 代理服务器上注册您的 IDE。<br />\nxdebug.remote_host 设置 dbgp_proxy_hostname_or_ip<br />\n (具体没试过，不会用到多用户调试，所以看之前别人的教程，一般调试，这个根本不用设置)</p>\n</li>\n</ul>\n</div>\n<h2 id=\"phpstorm配置\"><a class=\"anchor\" href=\"#phpstorm配置\">#</a> PhpStorm 配置</h2>\n<blockquote>\n<p>PhpStorm 支持使用两种最流行的工具进行调试：Xdebug 和 Zend Debugger, 这里介绍 Xdebug<br />\n 使用 PhpStorm，可以通过 主菜单 运行 / 调试配置 或 不使用它来启动 PHP 调试会话。后一种方法也称为零配置调试。</p>\n</blockquote>\n<h3 id=\"在-phpstorm-中配置-xdebug\"><a class=\"anchor\" href=\"#在-phpstorm-中配置-xdebug\">#</a> 在 PhpStorm 中配置 Xdebug</h3>\n<blockquote>\n<p>首先在 主菜单 文件 / 配置 | PHP &gt; 调试 配置中<br />\n主要配置就 Xdebug 里的调试端口号 要和 php.ini 的一致 也可以填写多个用逗号分隔 如 9000,9003,19000<br />\n 其他设置默认就行</p>\n</blockquote>\n<p><img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.6bga6pflkcg0.webp\" alt=\"1-0\" /></p>\n<h3 id=\"零配置调试\"><a class=\"anchor\" href=\"#零配置调试\">#</a> 零配置调试</h3>\n<blockquote>\n<p>在零配置调试的情况下，您不需要创建任何调试配置。<br />\n相反，您在浏览器中手动打开 PHP 应用程序的起始页面，然后从浏览器激活调试引擎，同时 PhpStorm 侦听传入的调试器连接。</p>\n</blockquote>\n<h4 id=\"浏览器激活调试引擎\"><a class=\"anchor\" href=\"#浏览器激活调试引擎\">#</a> 浏览器激活调试引擎</h4>\n<p><img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.qj47w9kfrqo.webp\" alt=\"1-1\" /></p>\n<h4 id=\"phpstorm-侦听传入的调试器连接\"><a class=\"anchor\" href=\"#phpstorm-侦听传入的调试器连接\">#</a> PhpStorm 侦听传入的调试器连接</h4>\n<p><img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/ALYJ25F77I~35A~%7DABYLJCQ.4bzeezdb94o.webp\" alt=\"1-2\" /></p>\n<h4 id=\"启动调试会话\"><a class=\"anchor\" href=\"#启动调试会话\">#</a> 启动调试会话</h4>\n<blockquote>\n<p>在浏览器中重新加载页面并返回到 PhpStorm，弹出对话框，选择接受 图 1<br />\n 此时会自动创建一个服务器配置 可以在主菜单 文件 / 设置 | PHP &gt; 服务器 查看 图 2<br />\n 重新加载页面，发现还是没有进入调试模式<br />\n查看配置后发现，映射路径只映射了 public 目录，手动加上了根目录的映射后，打上断点，再次重新加载，成功进入调试会话 图 3</p>\n</blockquote>\n<p>图 1<br />\n<img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.6judc6uwmxo0.webp\" alt=\"1-3\" /></p>\n<p>图 2<br />\n<img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.jc96wzwzuzs.webp\" alt=\"1-4\" /></p>\n<p>图 3<br />\n<img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.19x866m9o58g.webp\" alt=\"1-5\" /></p>\n<h3 id=\"根据配置模板创建配置调试\"><a class=\"anchor\" href=\"#根据配置模板创建配置调试\">#</a> 根据配置模板创建配置调试</h3>\n<h4 id=\"手动创建服务器配置\"><a class=\"anchor\" href=\"#手动创建服务器配置\">#</a> 手动创建服务器配置</h4>\n<blockquote>\n<p>上面讲到零配置调试，会自动创建一个服务器配置，如果已经有了就不需要创建，没有则手动创建一个<br />\n (主菜单 文件 / 设置 | PHP&gt; 服务器)<br />\n 因为我的环境在 linux 虚拟机里，所以需要做映射</p>\n</blockquote>\n<ul>\n<li>主机填项目的 ip 或者 域名 (测试 ip 需要做映射)</li>\n<li>端口号 (项目的端口号)</li>\n<li>调试器选择 (xdebug)</li>\n</ul>\n<p><img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.1kih9l21q7nk.webp\" alt=\"1-6\" /></p>\n<h4 id=\"使用-php-网页调试配置进行调试-php-web-page\"><a class=\"anchor\" href=\"#使用-php-网页调试配置进行调试-php-web-page\">#</a> 使用 PHP 网页调试配置进行调试 (PHP web page)</h4>\n<blockquote>\n<p>从主菜单中，选择 运行 / 编辑配置。<br />\n点击左上角 + 选择模板 PHP 网页 (PHP web page)，开始配置<br />\n配置完成后点击右上角的加调试按钮<br />\n自动打开浏览器，开始调试</p>\n</blockquote>\n<p><img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.47ealiycpu40.webp\" alt=\"1-7\" /></p>\n<ul>\n<li>选择刚刚配置好的服务器</li>\n<li>起始也看个人，一般默认 /</li>\n<li>选择浏览器，看个人</li>\n</ul>\n<p><img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.2l1nvnyex600.webp\" alt=\"1-8\" /></p>\n<h4 id=\"使用-php-远程调试配置进行调试-php-remote-debug\"><a class=\"anchor\" href=\"#使用-php-远程调试配置进行调试-php-remote-debug\">#</a> 使用 PHP 远程调试配置进行调试 (PHP Remote Debug)</h4>\n<blockquote>\n<p>从主菜单中，选择 运行 / 编辑配置。<br />\n点击左上角 + 选择模板 PHP 远程调试 (PHP Remote Debug)，开始配置<br />\n配置完成后点击右上角的加调试按钮，启动调试会话<br />\n需要手动打开网站，并且需要设置浏览器 xdebug 插件<br />\n右键 xdebug 图标，展开下拉菜单，点击” 选项 “，IDE 密钥选择 phpstorm<br />\n 这样就能开始调试了</p>\n</blockquote>\n<p><img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.209xe9kit400.webp\" alt=\"1-9\" /></p>\n<ul>\n<li>选择刚刚配置好的服务器</li>\n<li>IDE 键 (会话 ID) 自定义填写 一般填 PHPSTORM，以对应浏览器 xdebug 插件的 IDE 密钥</li>\n</ul>\n<p>配置窗口<br />\n<img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.2cc933tob8g0.webp\" alt=\"1-10\" /></p>\n<p>浏览器 xdebug 插件 选项配置<br />\n<img data-src=\"https://cdn.staticaly.com/gh/amber6hua/cdn@master/image-hosting/image.1zcudivno6tc.webp\" alt=\"1-11\" /></p>\n<h4 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h4>\n<ul>\n<li>零配置调试</li>\n</ul>\n<blockquote>\n<p>只要开启右上角监听调试的开关，和启用浏览器插件 xdebug<br />\n 重新加载网页，就能进入调试会话 (并且会自动创建一个服务器配置)</p>\n</blockquote>\n<ul>\n<li>PHP 网页调试</li>\n</ul>\n<blockquote>\n<p>需要手动创建服务器配置<br />\n点击右上角，调试按钮，能自动打开网页<br />\n会自动创建 为数字的 IDE key</p>\n</blockquote>\n<ul>\n<li>PHP 远程调试</li>\n</ul>\n<blockquote>\n<p>需要手动创建服务器配置<br />\n点击右上角，调试按钮，需要手动打开网页<br />\n并且预设的 IDE key 需要和浏览器插件 xdebug 内 IDE key 的相同</p>\n</blockquote>\n",
            "tags": [
                "PHP",
                "PHP"
            ]
        },
        {
            "id": "https://amber6hua.github.io/fastadmin/fastadmin-doc-9/",
            "url": "https://amber6hua.github.io/fastadmin/fastadmin-doc-9/",
            "title": "FastAdmin 个人记录 - thinkphp 多对多关联限制字段显示",
            "date_published": "2022-08-26T03:37:42.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<blockquote>\n<p>吐槽 thinkphp 说简单很简单 说麻烦真麻烦<br />\n官网讨论里，只有问题却没有答案<br />\n不知道为什么多对多关联中 field () 无效，找了半天也没有找到关于多对多的问题<br />\n这里以 cards 为例 只显示 id、des、 status<br />\n 记录解决办法</p>\n</blockquote>\n<h2 id=\"多对多限制字段显示的两种方式\"><a class=\"anchor\" href=\"#多对多限制字段显示的两种方式\">#</a> 多对多限制字段显示的两种方式</h2>\n<blockquote>\n<p>本来用方式一，但是如果主表字段多起起来，一个个显示好麻烦，考虑怎么只限制关联表字段<br />\n一开始看别人这么写不成功， $v-&gt;getRelation ('cards')-&gt;visible (['id','des','status']);<br />\n 提示错误 Call to a member function visible () on array<br />\n 打印了 $v-&gt;getRelation ('cards')； 发现这是个数组，本来想 foreach 循环 再用 visible<br />\n 然后想着 collection () 包装了下，成功了</p>\n</blockquote>\n<ul>\n<li>参考链接 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NTk4OTYzL2FydGljbGUvZGV0YWlscy8xMTM2ODE1MzQ=\">https://blog.csdn.net/qq_19598963/article/details/113681534</span></li>\n</ul>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token variable\">$list</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">model</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                    <span class=\"token operator\">-></span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cards'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                    <span class=\"token operator\">-></span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$list</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$k</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                    <span class=\"token comment\">//TODO 限制数据显示</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                    <span class=\"token comment\">// 方式一</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                    <span class=\"token variable\">$v</span><span class=\"token operator\">-></span><span class=\"token function\">visible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'cards.id'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'cards.des'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'cards.status'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                    <span class=\"token comment\">// 方式二</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    <span class=\"token function\">collection</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v</span><span class=\"token operator\">-></span><span class=\"token function\">getRelation</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cards'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">visible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'des'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'status'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    <span class=\"token comment\">// 同理 hidden 隐藏字段</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token variable\">$v</span><span class=\"token operator\">-></span><span class=\"token function\">hidden</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cards.pivot'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><h2 id=\"多对多-wherepivot-过滤条件\"><a class=\"anchor\" href=\"#多对多-wherepivot-过滤条件\">#</a> 多对多 wherePivot 过滤条件</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">cards</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 只显示 status 大于 0 的关联信息</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">belongsToMany</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'app\\admin\\model\\PersonalCard'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'app\\admin\\model\\GroupCard'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'cardID'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'groupID'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token operator\">-></span><span class=\"token function\">wherePivot</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'status'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'>'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "FastAdmin",
                "教程",
                "FastAdmin"
            ]
        },
        {
            "id": "https://amber6hua.github.io/fastadmin/fastadmin-doc-8/",
            "url": "https://amber6hua.github.io/fastadmin/fastadmin-doc-8/",
            "title": "FastAdmin 个人记录 - 修改table传递的参数",
            "date_published": "2022-08-19T03:05:02.000Z",
            "content_html": "<h2 id=\"后台php修改\"><a class=\"anchor\" href=\"#后台php修改\">#</a> 后台 php 修改</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#一般我们可以直接在控制器中使用以下代码获取请求的参数：</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$filter</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"filter\"</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$op</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"op\"</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'trim'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#通过 isset () 函数判断是否存在某个参数，然后利用 unset () 去除你不需要的参数；再通过</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$filter</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$op</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#设置你的自定义参数和查询条件；</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#然后进行重新赋值：</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'filter'</span> <span class=\"token operator\">=></span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filter</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">request</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'op'</span> <span class=\"token operator\">=></span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$op</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">list</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$where</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sort</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$order</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$offset</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$limit</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">buildparams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"前台table-js修改\"><a class=\"anchor\" href=\"#前台table-js修改\">#</a> 前台 table js 修改</h2>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>table<span class=\"token punctuation\">.</span><span class=\"token function\">bootstrapTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    url<span class=\"token operator\">:</span> $<span class=\"token punctuation\">.</span>fn<span class=\"token punctuation\">.</span>bootstrapTable<span class=\"token punctuation\">.</span>defaults<span class=\"token punctuation\">.</span>extend<span class=\"token punctuation\">.</span>index_url<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    pk<span class=\"token operator\">:</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    sortName<span class=\"token operator\">:</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    searchFormVisible<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    toolbar<span class=\"token operator\">:</span> <span class=\"token string\">'#toolbar'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function-variable function\">queryParams</span><span class=\"token operator\">:</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">params</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">let</span> filter <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">let</span> op <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 重构搜索条件 根据个人需求修改</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>filter<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            filter<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            op<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            params<span class=\"token punctuation\">.</span>filter <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>filter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            params<span class=\"token punctuation\">.</span>op <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token comment\">//console.log(params);</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">return</span> params<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    columns<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        col</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "FastAdmin",
                "教程",
                "FastAdmin"
            ]
        },
        {
            "id": "https://amber6hua.github.io/chrome-hevc/",
            "url": "https://amber6hua.github.io/chrome-hevc/",
            "title": "Chrome支持HEVC",
            "date_published": "2022-08-12T09:46:22.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>明明都是 mp4 格式，为什么有的视频，在 h5 播放器播放，只有声音，没有画面<br />\n常见的 mp4 编码为 H.264 能正常播放<br />\n而 H.265 (HEVC) 编码的视频就会发生无法正常播放的情况</p>\n<p>本来想找个好用的 h5 播放器，但是都不好用</p>\n<p>然后发现了个帖子，有位老哥之前做了可以让谷歌浏览器支持 HEVC</p>\n<p>最近谷歌浏览器也更新了 (version&gt;= 104.0.5084.0) 支持了 HEVC 解码</p>\n<h2 id=\"chrome设置启动参数\"><a class=\"anchor\" href=\"#chrome设置启动参数\">#</a> chrome 设置启动参数</h2>\n<p>在 chrome 桌面快捷方式设置 启动参数 --enable-features=&quot;PlatformHEVCDecoderSupport&quot;</p>\n<p>选择快捷方式图标<br />\n右键展开菜单<br />\n选择属性<br />\n快捷方式分页中 在” 目标 “输入框中 末尾加上 --enable-features=&quot;PlatformHEVCDecoderSupport&quot;<br />\n 然后重新打开浏览器，就可以了</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 例子</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token string\">\"C:\\Program Files\\Google\\Chrome\\Application<span class=\"token entity\" title=\"\\c\">\\c</span>hrome.exe\"</span> --enable-features<span class=\"token operator\">=</span><span class=\"token string\">\"PlatformHEVCDecoderSupport\"</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>浏览器版本不够的不想更新的，可以根据参考链接实现</p>\n</div>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3JlYWQvY3YxNjI5MzI4NS8=\">https://www.bilibili.com/read/cv16293285/</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1N0YVpodS9lbmFibGUtY2hyb21pdW0taGV2Yy1oYXJkd2FyZS1kZWNvZGluZw==\">https://github.com/StaZhu/enable-chromium-hevc-hardware-decoding</span></li>\n</ul>\n",
            "tags": [
                "教程",
                "教程"
            ]
        },
        {
            "id": "https://amber6hua.github.io/hexo/hello-world/",
            "url": "https://amber6hua.github.io/hexo/hello-world/",
            "title": "Hello World",
            "date_published": "2022-08-01T09:41:43.226Z",
            "content_html": "<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo</span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation</span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting</span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub</span>.</p>\n<h2 id=\"quick-start\"><a class=\"anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo new <span class=\"token string\">\"My New Post\"</span></pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing</span></p>\n<h3 id=\"run-server\"><a class=\"anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo server</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server</span></p>\n<h3 id=\"generate-static-files\"><a class=\"anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo generate</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating</span></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo deploy</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment</span></p>\n",
            "tags": [
                "hexo",
                "教程",
                "hexo"
            ]
        },
        {
            "id": "https://amber6hua.github.io/onedrive-download-aria/",
            "url": "https://amber6hua.github.io/onedrive-download-aria/",
            "title": "OneDrive SharePoint 利用Aria下载",
            "date_published": "2022-07-27T03:40:51.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>记录在 windows 下 OneDrive SharePoint 下载的两种办法 ，并且利用到 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FyaWEyL2FyaWEyL3JlbGVhc2Vz\"> Aria2 下载器</span></p>\n<ul>\n<li>\n<p>油猴脚本 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzQzMjQxNS1vbmVkcml2ZS0lRTYlOTYlODclRTQlQkIlQjYlRTQlQjglOEIlRTglQkQlQkQlRTclOUIlQjQlRTklOTMlQkU=\">onedrive - 文件下载直链</span></p>\n</li>\n<li>\n<p>python 脚本 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2dhb3dhbmxpYW5nL09uZURyaXZlU2hhcmVMaW5rUHVzaEFyaWEy\">OneDriveShareLinkPushAria2</span></p>\n</li>\n</ul>\n<h2 id=\"启动aria2\"><a class=\"anchor\" href=\"#启动aria2\">#</a> 启动 Aria2</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FyaWEyL2FyaWEyL3JlbGVhc2Vz\"> Aria2 下载器</span><br />\n解压后获得 Aria2 的文件夹<br />\n免安装，直接执行 aria2.exe 文件</p>\n<p>图形化界面 aria2Ng/index.html</p>\n<div class=\"note info\">\n<p>踩坑<br />\n默认下载内容中有 torrent 种子文件时，会自动下载<br />\n不需要的话修改，修改配置文件 aria2.conf<br />\n 当下载的是一个种子 (以.torrent 结尾) 时，自动开始 BT 任务，默认:true<br />\nfollow-torrent=false</p>\n</div>\n<h2 id=\"油猴脚本\"><a class=\"anchor\" href=\"#油猴脚本\">#</a> 油猴脚本</h2>\n<ul>\n<li>首先要给浏览器安装一个的拓展程序 TamperMonkey Beta (油猴)</li>\n<li>然后 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ncmVhc3lmb3JrLm9yZw==\">Greasy Fork</span> 脚本网站中找到 onedrive - 文件下载直链</li>\n</ul>\n<p>使用方便，但是不能区分文件夹<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzQzMjQxNS1vbmVkcml2ZS0lRTYlOTYlODclRTQlQkIlQjYlRTQlQjglOEIlRTglQkQlQkQlRTclOUIlQjQlRTklOTMlQkU=\"> onedrive - 文件下载直链</span><br />\n获得 OneDrive（Sharepoint，支持世纪互联） 文件下载直链的 TamperMonkey 插件。支持 IDM 批量下载、Aria2 推送下载</p>\n<h2 id=\"python脚本\"><a class=\"anchor\" href=\"#python脚本\">#</a> python 脚本</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2dhb3dhbmxpYW5nL09uZURyaXZlU2hhcmVMaW5rUHVzaEFyaWEy\">OneDriveShareLinkPushAria2</span></p>\n<blockquote>\n<p>ShareLink 分享的资源多，但是没法像百度网盘一样直接保存到自己的网盘中，下载内容多的时候也麻烦<br />\n这个脚本，通过把下载内容推送到 Aria2，并且包含目录层级<br />\n从 OneDrive 或 SharePoint 共享链接提取下载 URL 并将其推送到 aria2，即使在无图形界面的系统中 (如 Linux) 依然可以使用。</p>\n</blockquote>\n<p>下载完成后，需要准备好 python 环境<br />\n具体使用就不介绍了，除了分享链接，都是使用默认配置</p>\n<div class=\"note info\">\n<p>使用过程中 遇到下载的内容只有 507b<br />\n 看 issues 是请求频繁问题<br />\n我是在推送之前增加了一秒延迟<br />\n <code># todo</code>  下就是我加的代码</p>\n</div>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1tYWluLWZ0NGd1OWg5MjdoLnB5\">大致在 main.py</span> 的 326 行</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 省略部分代码</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'FSObjType'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token comment\"># 省略部分代码</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token comment\"># todo</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">if</span> fileCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">if</span> fileCount <span class=\"token operator\">></span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">if</span> num <span class=\"token operator\">==</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> fileCount <span class=\"token keyword\">in</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token comment\"># todo</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\t\"</span> <span class=\"token operator\">*</span> layers<span class=\"token punctuation\">,</span> <span class=\"token string\">\"文件 [%d]：%s\\t独特ID：%s\\t正在推送\"</span> <span class=\"token operator\">%</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                      <span class=\"token punctuation\">(</span>fileCount<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'FileLeafRef'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">\"UniqueId\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token comment\"># 省略部分代码</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token comment\"># exit(0)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\t\"</span> <span class=\"token operator\">*</span> layers<span class=\"token punctuation\">,</span> <span class=\"token string\">\"文件 [%d]：%s\\t独特ID：%s\\t非目标文件\"</span> <span class=\"token operator\">%</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                      <span class=\"token punctuation\">(</span>fileCount<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'FileLeafRef'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">\"UniqueId\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "教程",
                "教程"
            ]
        },
        {
            "id": "https://amber6hua.github.io/linux/linux-service-systemctl/",
            "url": "https://amber6hua.github.io/linux/linux-service-systemctl/",
            "title": "linux 下nginx加入 service systemctl",
            "date_published": "2022-07-06T08:57:28.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<blockquote>\n<p>nginx 安装成功后，可用使用 安装路径 /sbin/nginx -s start|reopen|reopen 等命令<br />\n也可以加入 service 或 systemctl 方便管理</p>\n</blockquote>\n<h2 id=\"service-配置流程\"><a class=\"anchor\" href=\"#service-配置流程\">#</a> service 配置流程</h2>\n<blockquote>\n<p>编辑编辑<br />\n vi /etc/init.d/nginx<br />\n 软链接 /etc/init.d/ 指向 /etc/rc.d/init.d/<br />\n 只要把下面的路径 改成自己的安装路径 /usr/local/webserver<br />\nNGINX_BIN='/usr/local/webserver/nginx/sbin/nginx'<br />\nCONFIG='/usr/local/webserver/nginx/conf/nginx.conf'<br />\n 保存后修改权限<br />\n chmod 755 nginx<br />\n 设置开启启动<br />\n /sbin/chkconfig nginx on<br />\nservice nginx status 查看是否配置完成</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token shebang important\">#! /bin/sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># chkconfig: 2345 55 25</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># Description: Startup script for nginx webserver on Debian. Place in /etc/init.d and</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># run 'update-rc.d -f nginx defaults', or use the appropriate command on your</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># distro. For CentOS/Redhat run: 'chkconfig --add nginx'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">### BEGIN INIT INFO</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># Provides:          nginx</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># Required-Start:    $all</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># Required-Stop:     $all</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># Default-Start:     2 3 4 5</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># Default-Stop:      0 1 6</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># Short-Description: starts the nginx web server</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># Description:       starts nginx using start-stop-daemon</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">### END INIT INFO</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># Author:   licess</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># website:  https://lnmp.org</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token assign-left variable\">NGINX_BIN</span><span class=\"token operator\">=</span><span class=\"token string\">'/usr/local/webserver/nginx/sbin/nginx'</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token assign-left variable\">CONFIG</span><span class=\"token operator\">=</span><span class=\"token string\">'/usr/local/webserver/nginx/conf/nginx.conf'</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token keyword\">in</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    start<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token builtin class-name\">echo</span> -n <span class=\"token string\">\"Starting nginx... \"</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token assign-left variable\">PID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ps</span> -ef <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"<span class=\"token variable\">$NGINX_BIN</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -v <span class=\"token function\">grep</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'&#123;print $2&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$PID</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"nginx (pid <span class=\"token variable\">$PID</span>) already running.\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token variable\">$NGINX_BIN</span> -c <span class=\"token variable\">$CONFIG</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$?</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" failed\"</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" done\"</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    stop<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token builtin class-name\">echo</span> -n <span class=\"token string\">\"Stoping nginx... \"</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token assign-left variable\">PID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ps</span> -ef <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"<span class=\"token variable\">$NGINX_BIN</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -v <span class=\"token function\">grep</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'&#123;print $2&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$PID</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"nginx is not running.\"</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token variable\">$NGINX_BIN</span> -s stop</pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$?</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" failed. Use force-quit\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            <span class=\"token variable\">$0</span> force-quit</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" done\"</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    status<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token assign-left variable\">PID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ps</span> -ef <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"<span class=\"token variable\">$NGINX_BIN</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -v <span class=\"token function\">grep</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'&#123;print $2&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$PID</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"nginx (pid <span class=\"token variable\">$PID</span>) is running...\"</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"nginx is stopped.\"</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    force-quit<span class=\"token operator\">|</span><span class=\"token function\">kill</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token builtin class-name\">echo</span> -n <span class=\"token string\">\"Terminating nginx... \"</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token assign-left variable\">PID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ps</span> -ef <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"<span class=\"token variable\">$NGINX_BIN</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -v <span class=\"token function\">grep</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'&#123;print $2&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$PID</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"nginx is is stopped.\"</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>            <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token function\">kill</span> <span class=\"token variable\">$PID</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$?</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" failed\"</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>            <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" done\"</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    restart<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>        <span class=\"token variable\">$0</span> stop</pre></td></tr><tr><td data-num=\"93\"></td><td><pre>        <span class=\"token function\">sleep</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>        <span class=\"token variable\">$0</span> start</pre></td></tr><tr><td data-num=\"95\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>    reload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        <span class=\"token builtin class-name\">echo</span> -n <span class=\"token string\">\"Reload nginx... \"</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>        <span class=\"token assign-left variable\">PID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ps</span> -ef <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"<span class=\"token variable\">$NGINX_BIN</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -v <span class=\"token function\">grep</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'&#123;print $2&#125;'</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$PID</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>            <span class=\"token variable\">$NGINX_BIN</span> -s reload</pre></td></tr><tr><td data-num=\"103\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" done\"</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>            <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"nginx is not running, can't reload.\"</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>            <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>        <span class=\"token keyword\">fi</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>    configtest<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>        <span class=\"token builtin class-name\">echo</span> -n <span class=\"token string\">\"Test nginx configure files... \"</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>        <span class=\"token variable\">$NGINX_BIN</span> -t</pre></td></tr><tr><td data-num=\"114\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>    *<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Usage: <span class=\"token variable\">$0</span> &#123;start|stop|restart|reload|status|configtest|force-quit|kill&#125;\"</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>        <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>        <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre></pre></td></tr><tr><td data-num=\"121\"></td><td><pre><span class=\"token keyword\">esac</span></pre></td></tr></table></figure><h2 id=\"systemctl-配置流程\"><a class=\"anchor\" href=\"#systemctl-配置流程\">#</a> systemctl 配置流程</h2>\n<blockquote>\n<p>systemctl 兼容 service<br />\n 即 systemctl 可用读取 /etc/init.d/ 下的程序<br />\n完成前面的步骤 可用直接执行 systemctl daemon-reload<br />\nsystemctl status nginx 查看<br />\n另外<br />\n Centos7 的服务 systemctl 脚本存放在：/usr/lib/systemd/ 目录下，有系统（system）和用户（user）之分，一般需要开机不登录就能运行的程序，就存放在 /usr/lib/systemd/system/ 目录下<br />\n /etc/systemd/system/ 软链接 指向 /usr/lib/systemd/system/<br />\nvi /etc/systemd/system/nginx.service<br />\n/usr/local/webserver 换成自己的安装路径<br />\n systemctl daemon-reload 重载 systemctl 配置<br />\n systemctl status nginx 查看状态<br />\n systemctl enable nginx 相当于 /sbin/chkconfig nginx on 设置开启启动</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>Unit<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">Description</span><span class=\"token operator\">=</span>The NGINX HTTP and reverse proxy server</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">After</span><span class=\"token operator\">=</span>network.target remote-fs.target nss-lookup.target</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>Service<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">Type</span><span class=\"token operator\">=</span>forking</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">PIDFile</span><span class=\"token operator\">=</span>/usr/local/webserver/nginx/nginx.pid</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/local/webserver/nginx/sbin/nginx -c /usr/local/webserver/nginx/conf/nginx.conf</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">ExecReload</span><span class=\"token operator\">=</span>/usr/local/webserver/nginx/sbin/nginx -s reload</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">ExecStop</span><span class=\"token operator\">=</span>/bin/kill -s QUIT <span class=\"token variable\">$MAINPID</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">PrivateTmp</span><span class=\"token operator\">=</span>false</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">[</span>Install<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token assign-left variable\">WantedBy</span><span class=\"token operator\">=</span>multi-user.target</pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://amber6hua.github.io/linux/linux-php-fpm-sock/",
            "url": "https://amber6hua.github.io/linux/linux-php-fpm-sock/",
            "title": "Centos下php-fpm使用sock",
            "date_published": "2022-06-22T02:37:16.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<blockquote>\n<p>php-fpm 默认 127.0.0.1:9000, 默认情况下监听端口 9000<br />\n 另外，也可以使 PHP-FPM 使用 Unix 套接字，这避免了 TCP 的开销</p>\n</blockquote>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8yOTY3MTEzNy9hcnRpY2xlL2RldGFpbHMvMTE1NTEzODk2\">https://blog.csdn.net/weixin_29671137/article/details/115513896</span></li>\n</ul>\n<h2 id=\"配置php-fpm\"><a class=\"anchor\" href=\"#配置php-fpm\">#</a> 配置 php-fpm</h2>\n<blockquote>\n<p>我的默认配置路径 （根据个人实际情况）<br />\n/usr/local/php/etc/php-fpm.conf<br />\n/usr/local/php/etc/php-fpm.d/www.conf</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">## 部分配置</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>user <span class=\"token operator\">=</span> www</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>group <span class=\"token operator\">=</span> www</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>listen <span class=\"token operator\">=</span> /tmp/php-cgi.sock</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>listen.owner <span class=\"token operator\">=</span> www</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>listen.group <span class=\"token operator\">=</span> www</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>listen.mode <span class=\"token operator\">=</span> 0660</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>listen.allowed_clients <span class=\"token operator\">=</span> <span class=\"token number\">127.0</span>.0.1</pre></td></tr></table></figure><blockquote>\n<p>配置完成后重启 php-fpm, 对应路径会生成 /tmp/php-cgi.sock</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> php-fpm restart</pre></td></tr></table></figure><h2 id=\"配置nginx-站点配置-server\"><a class=\"anchor\" href=\"#配置nginx-站点配置-server\">#</a> 配置 nginx 站点配置 server</h2>\n<blockquote>\n<p>我的默认配置路径 （根据个人实际情况）<br />\n/usr/local/webserver/nginx/conf/nginx.conf<br />\n/usr/local/webserver/nginx/vhost/www.conf<br />\n 修改 fastcgi_pass 127.0.0.1:9000; 为 fastcgi_pass unix:/tmp/php-cgi.sock;</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">## 部分配置</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>location ~ /<span class=\"token punctuation\">(</span>.+<span class=\"token punctuation\">\\</span>.php<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>/.+<span class=\"token punctuation\">)</span>*$ <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\"># try_files $uri =404;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\"># rewrite /(.+\\.php)(/.+)*$ /hello.html last;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\"># try_files $uri =404;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        client_max_body_size 10m<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        fastcgi_pass_header Authorization<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        fastcgi_split_path_info ^<span class=\"token punctuation\">(</span>.+<span class=\"token punctuation\">\\</span>.php<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>/.+<span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        fastcgi_pass unix:/tmp/php-cgi.sock<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        fastcgi_index index.php<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        include fastcgi_params<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        fastcgi_param SCRIPT_FILENAME <span class=\"token variable\">$document_root</span><span class=\"token variable\">$fastcgi_script_name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\"># fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        fastcgi_param PATH_INFO <span class=\"token variable\">$fastcgi_path_info</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        fastcgi_param PHP_ADMIN_VALUE <span class=\"token string\">\"open_basedir=<span class=\"token variable\">$document_root</span>/../:/tmp/:/proc/\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>配置完成后重启 nginx</p>\n</blockquote>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/usr/local/webserver/nginx/sbin/nginx -s reopen</pre></td></tr></table></figure>",
            "tags": [
                "Linux",
                "教程",
                "PHP",
                "Linux"
            ]
        }
    ]
}